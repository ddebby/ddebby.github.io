<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>å¼„æ‡‚word2vecä¹‹åŸç†è§£æ | Ebby&#39;s Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="äººå·¥æ™ºèƒ½,æ·±åº¦å­¦ä¹ ,æŠ€æœ¯,ç®—æ³•">
  
  
  
  
  <meta name="description" content="æ‘˜è¦ï¼š">
<meta name="keywords" content="äººå·¥æ™ºèƒ½,æ·±åº¦å­¦ä¹ ,æŠ€æœ¯,ç®—æ³•">
<meta property="og:type" content="article">
<meta property="og:title" content="å¼„æ‡‚word2vecä¹‹åŸç†è§£æ">
<meta property="og:url" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/index.html">
<meta property="og:site_name" content="Ebby&#39;s Notes">
<meta property="og:description" content="æ‘˜è¦ï¼š">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://blog.a-stack.com/qnsource/banner/07.jpg">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/word2vec_architectures.png">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/æ¨¡å‹åŸç†ç¤ºæ„.png">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/tokenize_lookup.png">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/training_data.png">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/skip_gram_net_arch.png">
<meta property="og:image" content="http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/sampled-softmax.png">
<meta property="og:updated_time" content="2018-08-24T15:18:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¼„æ‡‚word2vecä¹‹åŸç†è§£æ">
<meta name="twitter:description" content="æ‘˜è¦ï¼š">
<meta name="twitter:image" content="http://blog.a-stack.com/qnsource/banner/07.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Ebby&#39;s Notes" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/logo.png">
  <link rel="apple-touch-icon" href="/css/images/logo.png">
  
    <link href="/qnsource/css/Source+Code+Pro.css" rel="stylesheet" type="text/css">
  
  <link href="/qnsource/css/Open+Sans-Montserrat-700.css" rel="stylesheet" type="text/css">
  <link href="/qnsource/css/Roboto-400-300.css" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>
  <script src="/js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">

  
    <link rel="stylesheet" href="/css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css">
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css">
  

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 border-width: 0px;  margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="200px" height="100px" alt="Hike News" src="/css/images/logo.png">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">é¦–é¡µ</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">å½’æ¡£</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">åˆ†ç±»</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">æ ‡ç­¾</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">å…³äº</a> </li>
                
                  <li> <a class="main-nav-link" href="/reading">è¯»ä¹¦</a> </li>
                
                  <li> <a class="main-nav-link" href="/resources">èµ„æº</a> </li>
                
                  <li> <a class="main-nav-link" href="/notebooks">ğŸ“</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="è¯·è¾“å…¥å…³é”®è¯..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'æ–‡ç« ',
            PAGES: 'é¡µé¢',
            CATEGORIES: 'åˆ†ç±»',
            TAGS: 'æ ‡ç­¾',
            UNTITLED: '(æ— æ ‡é¢˜)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-å¼„æ‡‚word2vecä¹‹åŸç†è§£æ" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      å¼„æ‡‚word2vecä¹‹åŸç†è§£æ
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/" class="article-date">
	  <time datetime="2018-08-21T05:36:53.000Z" itemprop="datePublished">2018-08-21</time>
	</a>

      
    <a class="article-category-link" href="/categories/NLP/">NLP</a>

      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/qnsource/banner/07.jpg" alt="Test Picture"></p>
<p><strong>æ‘˜è¦ï¼š</strong></p>
<a id="more"></a>
<h2 id="å…³é”®ç‚¹æè¦"><a href="#å…³é”®ç‚¹æè¦" class="headerlink" title="å…³é”®ç‚¹æè¦"></a>å…³é”®ç‚¹æè¦</h2><ul>
<li>word2vecä¸æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆåªæœ‰è¾“å…¥å±‚ã€è¾“å‡ºå±‚ï¼‰</li>
<li>æ•ˆæœå¹¶éæœ€å¥½ï¼Œä½†æ˜“ç”¨æ€§æœ€å¼ºï¼ˆå…¶å®FastTextå¼€æºä¹‹åæ˜“ç”¨æ€§ç›´é€¼Word2vecï¼‰</li>
<li>å—è®­ç»ƒè¯­æ–™åº“å½±å“å¤§ï¼Œå°¤å…¶ä¸­æ–‡è¯­æ–™åº“æœ¬èº«ç¼ºä¹</li>
</ul>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Word2vecæ ¸å¿ƒç®—æ³•åŒ…æ‹¬CBOWå’Œskip-gramï¼Œå†åŠ ä¸Šä¸¤ç§ç›®æ ‡ä¼˜åŒ–æ–¹å¼å±‚æ¬¡Softmaxå’Œè´Ÿé‡‡æ ·çš„ç»„åˆï¼Œå¯ä»¥å½¢æˆæ€»å…±å››ç§å®ç°æ–¹å¼ã€‚éœ€è¦ç‰¹åˆ«ç†è§£çš„ä¸€ç‚¹ï¼Œå…¶å®è¯å‘é‡æ˜¯æ¨¡å‹çš„ä¸­é—´äº§ç‰©ï¼ˆè¯å‘é‡çŸ©é˜µåœ¨æ¨¡å‹ä¸­ä¸ºéšè—å±‚çš„æƒé‡å€¼ï¼‰è€Œä¸æ˜¯ä¼˜åŒ–ç›®æ ‡äº§ç‰©ã€‚æ¨¡å‹çš„è®­ç»ƒæ•°æ®ä¸ºï¼ˆsourcewordï¼Œtargetwordï¼‰çš„è¯è¯­å¯¹ã€‚æœ¬æ–‡ç®€å•æ•´ç†è¿‘æ®µæ—¶é—´é€šè¿‡ç¿»çœ‹ä»£ç ã€åŸç†è§£ææ€»ç»“çš„ä¸€äº›å¯¹word2vecçš„è®¤çŸ¥ï¼Œå¸Œæœ›èƒ½å¤ŸåŠ æ·±å¯¹æ•´åˆè¯åµŒå…¥æ¨¡å‹çš„ç†è§£ã€‚</p>
<p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/word2vec_architectures.png" alt="word2vec_architectures"></p>
<p>å…¶ä¸­</p>
<ul>
<li>CBOWçš„å®ç°åŸç†ä¸ºç”±ä¸­å¿ƒè¯æ¥é¢„æµ‹å‰åçš„ç›¸å…³è¯ï¼›</li>
<li>Skip-Gramæ­£å¥½ç›¸åï¼Œä¸ºç”±ä¸­å¿ƒè¯çš„å‰åç›¸å…³è¯æ¥å€’æ¨ä¸­å¿ƒè¯ä¸ºæŸè¯çš„å¯èƒ½æ€§ï¼›</li>
<li>æ— è®ºå“ªç§æ–¹æ³•ï¼Œéƒ½ä¸éœ€è¦äº‹å…ˆå¯¹æ•°æ®è¿›è¡Œæ ‡è®°ï¼Œæ¢å¥è¯è¯´è¿™å¯ä»¥çœ‹ä½œä¸€ç§æ— ç›‘ç£çš„å­¦ä¹ æ–¹æ³•ã€‚</li>
</ul>
<blockquote>
<p>æœ‰ç›¸å…³ç ”ç©¶ä¹Ÿå¯¹ä¸¤ç§æ–¹æ³•çš„å®ç°æ•ˆæœè¿›è¡Œäº†æ¯”è¾ƒï¼ŒCBOWåœ¨å°æ•°æ®é›†ä¸Šè¡¨ç°è¦ä¼˜äºSkip-Gramï¼Œåœ¨å¤§æ•°æ®é›†åˆä¸Šä¸¤è€…ç›¸å½“ã€‚</p>
</blockquote>
<p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/æ¨¡å‹åŸç†ç¤ºæ„.png" alt="æ¨¡å‹åŸç†ç¤ºæ„"></p>
<h2 id="è®­ç»ƒæ•°æ®çš„å®šä¹‰"><a href="#è®­ç»ƒæ•°æ®çš„å®šä¹‰" class="headerlink" title="è®­ç»ƒæ•°æ®çš„å®šä¹‰"></a>è®­ç»ƒæ•°æ®çš„å®šä¹‰</h2><blockquote>
<p>è¯¦è§ä»£ç </p>
</blockquote>
<p>åœ¨ç”Ÿæˆè®­ç»ƒæ•°æ®ä¹‹å‰å…ˆè¦æ˜ç¡®çª—å£çš„æ¦‚å¿µï¼Œçª—å£çš„æ¦‚å¿µä¸n-gramä¸­å¼ºè°ƒçš„å‰åè¯ä¹‹å‰çš„è¯­ä¹‰å…³è”æœ‰å…³ï¼Œç”¨äºæè¿°æŸä¸ªè¯è¯­ä¸å…¶åå¤šä¸ªè¯è¯­æœ‰ç›´æ¥æˆ–é—´æ¥çš„å…³ç³»ã€‚åœ¨word2vecä¸­ä½¿ç”¨çš„æ˜¯ä¸­å¿ƒè¯å‰åå„nä¸ªè¯ç»„æˆçš„çª—å£å¤§å°ã€‚åŸåˆ™ä¸Šï¼Œçª—å£è®¾ç½®è¶Šå¤§é¢„æµ‹æ•ˆæœè¶Šå¥½ï¼Œä½†è®¡ç®—é‡ç­‰æ¯”ä¾‹å¢å¤§ï¼Œä¸€èˆ¬é€‰æ‹©5-8ä½œä¸ºæ°å½“çš„çª—å£å€¼ã€‚</p>
<p><strong>Embedding Lookupçš„è§£é‡Š</strong>ï¼šè¯å‘é‡å­˜å‚¨ä¸ºä¸€ä¸ªä»¥è¯å…¸è¯ä¸ªæ•°ä¸ºè¡Œï¼Œè¯åµŒå…¥ç»´åº¦ä¸ºåˆ—çš„æƒé‡çŸ©é˜µï¼Œè€Œè¾“å…¥å•è¯å¯ä»¥è¢«ç¼–ç ä¸ºæ•°å­—å€¼ï¼Œåˆ©ç”¨æ•°å€¼åœ¨è¯å‘é‡çŸ©é˜µä¸­è·å¾—è¯çš„å‘é‡è¡¨è¾¾çš„è¿‡ç¨‹æˆä¸ºEmbedding Lookup.</p>
<p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/tokenize_lookup.png" alt="tokenize_lookup"></p>
<p>Words that show up often such as â€œtheâ€, â€œofâ€, and â€œforâ€ donâ€™t provide much context to the nearby words. If we discard some of them, we can remove some of the noise from our data and in return get faster training and better representations. This process is called subsampling by Mikolov. For each word $w_i$ in the training set, weâ€™ll discard it with probability given by </p>
<script type="math/tex; mode=display">
 P(w_i) = 1 - \sqrt{\frac{t}{f(w_i)}}</script><p>where $t$ is a threshold parameter and $f(w_i)$ is the frequency of word $w_i$ in the total dataset.</p>
<h3 id="è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†"><a href="#è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†" class="headerlink" title="è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†"></a>è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†</h3><p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/training_data.png" alt="training_data"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">corpus = <span class="string">''' I read magazine weekly . </span></span><br><span class="line"><span class="string">I read newspaper daily . I like to read books daily .'''</span></span><br><span class="line"></span><br><span class="line">corpus_tokens = []</span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> corpus.split(<span class="string">'.'</span>):</span><br><span class="line">    corpus_tokens.append(text.lower().split())</span><br><span class="line"></span><br><span class="line"><span class="comment">########## Create vocabulary </span></span><br><span class="line">vocab = &#123;&#125;</span><br><span class="line">counter = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> sentence_tokens <span class="keyword">in</span> corpus_tokens:</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> sentence_tokens:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> vocab:</span><br><span class="line">            vocab[word] = counter</span><br><span class="line">            counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########## Create training pairs .</span></span><br><span class="line">window = <span class="number">5</span></span><br><span class="line">target_words = []</span><br><span class="line">target_words_index = []</span><br><span class="line">c = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> corpus_tokens:</span><br><span class="line">    <span class="keyword">for</span> index,center_word <span class="keyword">in</span> enumerate(i):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            right = i[index+<span class="number">1</span>: index+<span class="number">1</span>+window]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            right == []</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            left = i[index<span class="number">-1</span>: (index<span class="number">-1</span>)+window]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            left == []</span><br><span class="line">        total_words = list(set(right+left))</span><br><span class="line">        <span class="keyword">if</span> total_words:</span><br><span class="line">            <span class="keyword">for</span> word <span class="keyword">in</span> total_words:</span><br><span class="line">                <span class="keyword">if</span> center_word <span class="keyword">in</span> vocab <span class="keyword">and</span> word <span class="keyword">in</span> vocab:</span><br><span class="line">                    target_words.append((center_word, word))</span><br><span class="line">                    target_words_index.append((vocab[center_word], vocab[word]))</span><br><span class="line">    c += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="ç½‘ç»œçš„æ„å»º"><a href="#ç½‘ç»œçš„æ„å»º" class="headerlink" title="ç½‘ç»œçš„æ„å»º"></a>ç½‘ç»œçš„æ„å»º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">embedding_dimension = <span class="number">100</span></span><br><span class="line">n_classes           = len(vocab) </span><br><span class="line">X = np.random.uniform(<span class="number">-1</span>,<span class="number">1</span>, (len(vocab), embedding_dimension)) <span class="comment"># input features for X </span></span><br><span class="line">W = np.random.uniform(<span class="number">-1</span>,<span class="number">1</span>, (len(vocab), embedding_dimension))   </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each_pair <span class="keyword">in</span> target_words_index:</span><br><span class="line">    </span><br><span class="line">    inp_pair_index = each_pair[<span class="number">0</span>]</span><br><span class="line">    op_pair_index  = each_pair[<span class="number">1</span>] </span><br><span class="line">    </span><br><span class="line">    x_input = random_embeddings[inp_pair_index] <span class="comment"># 1 x embedding_dimension </span></span><br><span class="line">    </span><br><span class="line">    probs = softmax(np.dot(W, x_input))        <span class="comment"># 1 x n_classes   </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">####### loss(probs, op_pair_index)</span></span><br><span class="line">    <span class="comment">####### backpropagate , update W</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è™½ç„¶ç¤ºæ„ä»£ç ä¸­ä½¿ç”¨äº†softmaxï¼Œä½†ä»è®¡ç®—é‡ä¸Šæ¥çœ‹è¿™å¹¶éä¸€ç§å¥½çš„æ–¹æ³•ï¼› Word2vecä¸­ä½¿ç”¨äº†ä¸¤ç§æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥å¤§å¤§èŠ‚çº¦è®¡ç®—æˆæœ¬ï¼šåˆ†åˆ«æ˜¯å±‚æ¬¡softmaxå’Œå‰¯é‡‡æ ·ç®—æ³•ï¼› </p>
</blockquote>
<h2 id="CBOW"><a href="#CBOW" class="headerlink" title="CBOW"></a>CBOW</h2><h2 id="Skip-gram"><a href="#Skip-gram" class="headerlink" title="Skip-gram"></a>Skip-gram</h2><p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/skip_gram_net_arch.png" alt="skip_gram_net_arch"></p>
<h2 id="è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰"><a href="#è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰" class="headerlink" title="è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰"></a>è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰</h2><p><img src="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/sampled-softmax.png" alt="sampled-softmax"></p>
<p>å…¶ä¸­å‰ä¸€éƒ¨åˆ†ä¸ºçœŸå®ç»“æœçš„æŸå¤±æƒ©ç½šï¼Œåé¢çš„Kéƒ¨åˆ†ä¸ºå™ªå£°è¯ç»„çš„Kæ¬¡é‡‡æ ·ã€‚</p>
<p>TensorFlowå®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Number of negative labels to sample</span></span><br><span class="line">n_sampled = <span class="number">100</span></span><br><span class="line"><span class="keyword">with</span> train_graph.as_default():</span><br><span class="line">    softmax_w = tf.Variable(tf.truncated_normal((n_vocab, n_embedding))) <span class="comment"># create softmax weight matrix here</span></span><br><span class="line">    softmax_b = tf.Variable(tf.zeros(n_vocab), name=<span class="string">"softmax_bias"</span>) <span class="comment"># create softmax biases here</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate the loss using negative sampling</span></span><br><span class="line">    loss = tf.nn.sampled_softmax_loss(</span><br><span class="line">        weights=softmax_w,</span><br><span class="line">        biases=softmax_b,</span><br><span class="line">        labels=labels,</span><br><span class="line">        inputs=embed,</span><br><span class="line">        num_sampled=n_sampled,</span><br><span class="line">        num_classes=n_vocab)</span><br><span class="line">    </span><br><span class="line">    cost = tf.reduce_mean(loss)</span><br><span class="line">    optimizer = tf.train.AdamOptimizer().minimize(cost)</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a href="https://zhuanlan.zhihu.com/p/29364112" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/29364112</a></li>
<li><a href="https://www.tensorflow.org/tutorials/representation/word2vec" target="_blank" rel="noopener">https://www.tensorflow.org/tutorials/representation/word2vec</a></li>
</ol>

      
    </div>
    <footer class="article-footer">

      
        <div id="donation_div"></div>

<script src="/js/vdonate.js"></script>
<script>
var a = new Donate({
  title: 'å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹æ‚¨æœ‰ç”¨ï¼Œè¯·éšæ„æ‰“èµã€‚æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œ!', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæ ‡é¢˜
  btnText: 'æ‰“èµæ”¯æŒ', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæŒ‰é’®æ–‡å­—
  el: document.getElementById('donation_div'),
  wechatImage: '/qnsource/site/weixin.png',
  alipayImage: '/qnsource/site/alipay.jpg'
});
</script>
      
      
      <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>æœ¬æ–‡ä½œè€…:  </strong>Ebby DD</a>
          </li>
          <li class="post-copyright-link">
          <strong>æœ¬æ–‡é“¾æ¥:  </strong>
          <a href="/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/" target="_blank" title="å¼„æ‡‚word2vecä¹‹åŸç†è§£æ">http://blog.a-stack.com/2018/08/21/å¼„æ‡‚word2vecä¹‹åŸç†è§£æ/</a>
          </li>
          <li class="post-copyright-license">
            <strong>ç‰ˆæƒå£°æ˜:   </strong>
            æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„
          </li>
         
        </ul>
<div>

      

      
        
 <!-- valine @ebby -->
 <section id="comments" class="comments">
	<style>
		.comments{margin:30px;padding:10px;background:#fff}
		@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}
	</style>
	<div id="vcomment" class="comment"></div>
<script src="//cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script>
<script src='//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js'></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'false' == true ? true : false;
   new Valine({
            av: AV,
            el: '#vcomment',
            notify: notify,
            verify: verify,
            app_id: "JQMgg0zbFBNWwL0lLnq2s1G7-gzGzoHsz",
            app_key: "m5FMVedFNxGutQCnMsVMAaXM",
            placeholder: "Say Something ...",
            avatar: "wavatar",
            avatar_cdn: "https://sdn.geekzu.org/avatar/",
            pageSize: "15"
    });
</script>
		
</section>



      
      <!--  -->

      <!--  -->
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/word2vec/">word2vec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/åŸç†è§£æ/">åŸç†è§£æ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è¯åµŒå…¥/">è¯åµŒå…¥</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/08/21/FastText-A-better-choice-for-word-embedding/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
      <div class="article-nav-title">
        
          FastText-A better choice for word embedding?
        
      </div>
    </a>
  
  
    <a href="/2018/08/21/å¼„æ‡‚word2vecä¹‹å®è·µ/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
      <div class="article-nav-title">å¼„æ‡‚word2vecä¹‹å®è·µ</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å…³é”®ç‚¹æè¦"><span class="nav-number">1.</span> <span class="nav-text">å…³é”®ç‚¹æè¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¦‚è¿°"><span class="nav-number">2.</span> <span class="nav-text">æ¦‚è¿°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è®­ç»ƒæ•°æ®çš„å®šä¹‰"><span class="nav-number">3.</span> <span class="nav-text">è®­ç»ƒæ•°æ®çš„å®šä¹‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†"><span class="nav-number">3.1.</span> <span class="nav-text">è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç½‘ç»œçš„æ„å»º"><span class="nav-number">3.2.</span> <span class="nav-text">ç½‘ç»œçš„æ„å»º</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CBOW"><span class="nav-number">4.</span> <span class="nav-text">CBOW</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Skip-gram"><span class="nav-number">5.</span> <span class="nav-text">Skip-gram</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰"><span class="nav-number">6.</span> <span class="nav-text">è´Ÿé‡‡æ ·æŸå¤±å‡½æ•°å®šä¹‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒ"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol>
    
    </div>
  </aside>

</section>      
        
      </div>
      <!--  -->
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2017 - 2020 Ebby&#39;s Notes All Rights Reserved.</p>
	      
	      
  		   	<p id="copyRightCn">Ebby DD ä¿ç•™æ‰€æœ‰æƒåˆ©</p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>    
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/reading" class="mobile-nav-link">Reading</a>
  
    <a href="/resources" class="mobile-nav-link">Resources</a>
  
    <a href="/notebooks" class="mobile-nav-link">ğŸ“</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">

</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/scripts.js"></script>




  <script src="/js/dialog.js"></script>











	<script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?684368b6943d7a5b6689dba5e7bf30ad";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">è®¾ç½®</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              æ­£æ–‡å­—å·å¤§å°
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            æ‚¨å·²è°ƒæ•´é¡µé¢å­—ä½“å¤§å°
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              å¤œé—´æŠ¤çœ¼æ¨¡å¼
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            å¤œé—´æ¨¡å¼å·²ç»å¼€å¯ï¼Œå†æ¬¡å•å‡»æŒ‰é’®å³å¯å…³é—­ 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å…³ äº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Ebby&#39;s Notes
          </div>
          <div class="panel-body">
            Copyright Â© 2020 Ebby DD All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>