<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 3.9.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>æ ‡ç­¾: æœºå™¨è§†è§‰ - Ebby&#39;s Notes</title>


    <meta name="description" content="è®°å½•äººå·¥æ™ºèƒ½å­¦ä¹ è·¯å¾„">
<meta name="keywords" content="äººå·¥æ™ºèƒ½, AI, ç¥ç»ç½‘ç»œ, ç®—æ³•">
<meta property="og:type" content="website">
<meta property="og:title" content="Ebby&#39;s Notes">
<meta property="og:url" content="http://blog.a-stack.com/tags/æœºå™¨è§†è§‰/index.html">
<meta property="og:site_name" content="Ebby&#39;s Notes">
<meta property="og:description" content="è®°å½•äººå·¥æ™ºèƒ½å­¦ä¹ è·¯å¾„">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://blog.a-stack.com/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ebby&#39;s Notes">
<meta name="twitter:description" content="è®°å½•äººå·¥æ™ºèƒ½å­¦ä¹ è·¯å¾„">
<meta name="twitter:image" content="http://blog.a-stack.com/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/tomorrow-night-eighties.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    <script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?684368b6943d7a5b6689dba5e7bf30ad";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo02.png" alt="Ebby&#39;s Notes" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">ä¸»é¡µ</a>
                
                <a class="navbar-item"
                href="/archives">å½’æ¡£</a>
                
                <a class="navbar-item"
                href="/categories">åˆ†ç±»</a>
                
                <a class="navbar-item"
                href="/tags">æ ‡ç­¾</a>
                
                <a class="navbar-item"
                href="/reading">è¯»ä¹¦</a>
                
                <a class="navbar-item"
                href="/resources">èµ„æº</a>
                
                <a class="navbar-item"
                href="/notebooks">ğŸ“</a>
                
                <a class="navbar-item"
                href="/about">å…³äº</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="æœç´¢" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">æ ‡ç­¾</a></li>
            <li class="is-active"><a href="#" aria-current="page">æœºå™¨è§†è§‰</a></li>
        </ul>
        </nav>
    </div>
</div>

    
<div class="card">
    
    <div class="card-image">
        <a href="/2018/05/21/ResNet/" class="image is-7by1">
            <img class="thumbnail" src="http://p4ygzcmtw.bkt.clouddn.com/cover/04.jpg" alt="ç»å…¸ç½‘ç»œå½’çº³ï¼š ResNet">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-21T12:14:49.000Z">2018-05-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1398 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/21/ResNet/">ç»å…¸ç½‘ç»œå½’çº³ï¼š ResNet</a>
            
        </h1>
        <div class="content">
            <p><img src="/qnsource/cover/04.jpg" alt="Test Picture"></p>
<p><strong>æ‘˜è¦ï¼š</strong> ä½œä¸ºæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œçš„é‡Œç¨‹ç¢‘å¼çš„ä½œå“ï¼ŒResNetä¸ºå·ç§¯ç½‘ç»œå¾€æ›´æ·±å±‚æ¬¡æ‰©å±•æŒ‡æ˜äº†æ–¹å‘ï¼Œæœ¬æ–‡ç»“åˆç›¸å…³è®ºæ–‡æ€»ç»“ä¸€ä¸‹ResNetä¸­åˆ›é€ æ€§çš„æƒ³æ³•ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/å›¾åƒåˆ†ç±»/">å›¾åƒåˆ†ç±»</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æ–‡çŒ®/">æ–‡çŒ®</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç®—æ³•/">ç®—æ³•</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/21/ResNet/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-07T08:50:26.000Z">2018-05-07</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/è¯¾ç¨‹ç¬”è®°/">è¯¾ç¨‹ç¬”è®°</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1000 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/07/cs231n-lecture-6/">cs231nè¯¾ç¨‹ç¬”è®°:ï¼ˆLecture 6-7ï¼‰Training Neural Networks</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> è®¡åˆ’èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´åˆ·ä¸€éæ–¯å¦ç¦çš„æœºå™¨è§†è§‰è¯¾ç¨‹cs231nï¼Œå¹¶åšç¬”è®°è®°å½•æ¯å¤©å­¦ä¹ åˆ°çš„å†…å®¹ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç¬”è®°/">ç¬”è®°</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/07/cs231n-lecture-6/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-03T08:55:26.000Z">2018-05-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/è¯¾ç¨‹ç¬”è®°/">è¯¾ç¨‹ç¬”è®°</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 972 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/03/cs231n-lecture-5/">cs231nè¯¾ç¨‹ç¬”è®°:ï¼ˆLecture 5ï¼‰CNNåŸºç¡€</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> è®¡åˆ’èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´åˆ·ä¸€éæ–¯å¦ç¦çš„æœºå™¨è§†è§‰è¯¾ç¨‹cs231nï¼Œå¹¶åšç¬”è®°è®°å½•æ¯å¤©å­¦ä¹ åˆ°çš„å†…å®¹ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç¬”è®°/">ç¬”è®°</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/03/cs231n-lecture-5/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-03T08:52:26.000Z">2018-05-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/è¯¾ç¨‹ç¬”è®°/">è¯¾ç¨‹ç¬”è®°</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    21 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3101 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/03/cs231n-lecture-4/">cs231nè¯¾ç¨‹ç¬”è®°ï¼šï¼ˆLecture 4ï¼‰ç¥ç»ç½‘ç»œåŸºç¡€</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> è®¡åˆ’èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´åˆ·ä¸€éæ–¯å¦ç¦çš„æœºå™¨è§†è§‰è¯¾ç¨‹cs231nï¼Œå¹¶åšç¬”è®°è®°å½•æ¯å¤©å­¦ä¹ åˆ°çš„å†…å®¹ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç¬”è®°/">ç¬”è®°</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/03/cs231n-lecture-4/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-03T08:51:26.000Z">2018-05-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/è¯¾ç¨‹ç¬”è®°/">è¯¾ç¨‹ç¬”è®°</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1603 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/03/cs231n-lecture-3/">cs231nè¯¾ç¨‹ç¬”è®°:ï¼ˆLecture 3ï¼‰çº¿æ€§åˆ†ç±»å™¨å’Œä¼˜åŒ–æ–¹æ³•</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> è®¡åˆ’èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´åˆ·ä¸€éæ–¯å¦ç¦çš„æœºå™¨è§†è§‰è¯¾ç¨‹cs231nï¼Œå¹¶åšç¬”è®°è®°å½•æ¯å¤©å­¦ä¹ åˆ°çš„å†…å®¹ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç¬”è®°/">ç¬”è®°</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/03/cs231n-lecture-3/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-05-03T08:50:26.000Z">2018-05-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/è¯¾ç¨‹ç¬”è®°/">è¯¾ç¨‹ç¬”è®°</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1317 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/03/cs231n-lecture-2/">cs231nè¯¾ç¨‹ç¬”è®°:ï¼ˆLecture 2ï¼‰å›¾åƒåˆ†ç±»</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> è®¡åˆ’èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´åˆ·ä¸€éæ–¯å¦ç¦çš„æœºå™¨è§†è§‰è¯¾ç¨‹cs231nï¼Œå¹¶åšç¬”è®°è®°å½•æ¯å¤©å­¦ä¹ åˆ°çš„å†…å®¹ã€‚</p>
        </div>
        
        
        <hr style="height:1px;margin:1rem 0"/>
         <div class="level is-mobile is-flex">
         <div class="level-start">
          
          <div class="level-item is-size-7 is-uppercase">
           <i class="fas fa-tags has-text-grey"></i>&nbsp;
             <a class="has-link-grey -link" href="/tags/äººå·¥æ™ºèƒ½/">äººå·¥æ™ºèƒ½</a>,&nbsp;<a class="has-link-grey -link" href="/tags/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>,&nbsp;<a class="has-link-grey -link" href="/tags/ç¬”è®°/">ç¬”è®°</a>
         </div>
         
         </div>

            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/05/03/cs231n-lecture-2/#more">é˜…è¯»æ›´å¤š</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-04-11T06:44:58.000Z">2018-04-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/åŠ¨æ‰‹å®è·µè¥/">åŠ¨æ‰‹å®è·µè¥</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2546 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/04/11/Vechicle-identification-by-stanford-car-dataset/">åˆ©ç”¨è¿ç§»å­¦ä¹ å®ç°è½¦è¾†è¯†åˆ«</a>
            
        </h1>
        <div class="content">
            <p><strong>æ‘˜è¦ï¼š</strong> åˆ©ç”¨è¿ç§»å­¦ä¹ æŠ€æœ¯è®­ç»ƒè¯†åˆ«æ±½è½¦å‚å•†å’Œæ¬¾å¼çš„æ¨¡å‹ã€‚<br><!-- excerpt --></p>
<p>@[toc]</p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><h3 id="æ•°æ®é›†ï¼š-Stanford-Cars-Dataset"><a href="#æ•°æ®é›†ï¼š-Stanford-Cars-Dataset" class="headerlink" title="æ•°æ®é›†ï¼š Stanford Cars Dataset"></a>æ•°æ®é›†ï¼š Stanford Cars Dataset</h3><ul>
<li>æ•°æ®é›†ç»„æˆï¼šåŒ…å«<strong>196</strong>ç§è½¦è¾†çš„<strong>16,185</strong>å¼ ç…§ç‰‡ï¼›å…¶ä¸­è®­ç»ƒé›†8144ï¼Œæµ‹è¯•é›†8041ï¼›</li>
<li>å…³é”®ç‰¹å¾åŒ…æ‹¬ï¼šè½¦è¾†åˆ¶é€ å•†ã€æ¬¾å¼ã€ç”Ÿäº§æ—¥æœŸï¼ˆæ¯”å¦‚ï¼š2012 Tesla Model Sï¼‰ï¼›</li>
<li>ä¸‹è½½åœ°å€ï¼š<a href="https://ai.stanford.edu/~jkrause/cars/car_dataset.htmlï¼›">https://ai.stanford.edu/~jkrause/cars/car_dataset.htmlï¼›</a></li>
<li>ç›¸å…³è®ºæ–‡ï¼š<a href="https://ai.stanford.edu/~jkrause/papers/3drr13.pdf"><strong>3D Object Representations for Fine-Grained Categorization</strong></a>ï¼ŒJonathan Krause, Michael Stark, Jia Deng, Li Fei-Fei</li>
</ul>
<p><img src="/qnsource/images/2018-04-11-vechicle-identification-by-stanford-car-dataset/car.jpg" alt="car"></p>
<blockquote>
<p><strong>æ•°æ®é›†ç‰¹ç‚¹ï¼š</strong></p>
<ol>
<li>å­˜åœ¨æ˜æ˜¾çš„æ•°æ®ä¸å¹³è¡¡é—®é¢˜ï¼›</li>
<li>æ¯ä¸ªåˆ†ç±»å›¾åƒæ•°ç›®è¿‡å°‘ï¼Œæ— æ³•è¾¾åˆ°å‡†ç¡®é¢„æµ‹åˆ†ç±»ç›®æ ‡çš„åŸºå‡†ï¼›</li>
</ol>
</blockquote>
<p>é’ˆå¯¹æ•°æ®é›†çš„ç‰¹ç‚¹ï¼Œåˆ©ç”¨è¿ç§»å­¦ä¹ Fine-Tuneæ¥è®­ç»ƒä¸€ä¸ªåœ¨ImageNetä¸Šé¢„è®­ç»ƒçš„æ¨¡å‹æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹å¼ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»æ•°æ®çš„å‡†å¤‡å¼€å§‹ä¸€æ­¥æ­¥å¾—å®Œæˆæ¨¡å‹çš„è®­ç»ƒä»»åŠ¡ã€‚</p>
<h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><p>åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è¯»å…¥åŸå§‹æ•°æ®ï¼Œè¿›è¡ŒåŸºæœ¬çš„æ•°æ®å¤„ç†ï¼Œç„¶åå¯¹æ•°æ®è¿›è¡Œç»Ÿä¸€å­˜å‚¨ï¼Œä¸€èˆ¬é¢å¯¹å¤§è§„æ¨¡çš„æ•°æ®é›†å¯ä»¥é€‰ç”¨<code>HDF5</code>æˆ–MXNetçš„.<code>LST</code>æ ¼å¼è¿›è¡Œå­˜å‚¨ã€‚</p>
<blockquote>
<p>é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œå­˜å‚¨å¯ä»¥è§£å†³æ¯å¼ å›¾ç‰‡è¯»å–éƒ½è¦äº§ç”Ÿä¸€æ¬¡IOå¸¦æ¥çš„è®¿é—®æ—¶å»¶ï¼ŒåŒæ—¶å¯ä»¥åˆ©ç”¨å­˜å‚¨ç³»ç»Ÿè¿ç»­è¯»çš„æ–¹å¼ï¼Œç›´æ¥å¯¹å¤§è§„æ¨¡æ•°æ®é›†è¿›è¡Œåˆ‡ç‰‡æ“ä½œã€‚</p>
</blockquote>
<h3 id="é…ç½®ä¿¡æ¯"><a href="#é…ç½®ä¿¡æ¯" class="headerlink" title="é…ç½®ä¿¡æ¯"></a>é…ç½®ä¿¡æ¯</h3><p>ä¸ºäº†é…åˆåç»­å¤„ç†æµç¨‹æ–¹ä¾¿ï¼Œæ–°å»ºä¸€ä¸ª<code>car.config</code>çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºå¯¹ç›¸å…³é…ç½®ä¿¡æ¯çš„å­˜å‚¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="comment"># define the base path to the cars dataset</span></span><br><span class="line">BASE_PATH = <span class="string">"Path-to-car-dataset"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># based on the base path, derive the images path and meta file path</span></span><br><span class="line">IMAGES_PATH = path.sep.join([BASE_PATH, <span class="string">"car_ims"</span>])</span><br><span class="line">LABELS_PATH = path.sep.join([BASE_PATH, <span class="string">"complete_dataset.csv"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#define path for HDF5</span></span><br><span class="line">TRAIN_HDF5 = path.sep.join([MX_OUTPUT, <span class="string">"hdf5/train.hdf5"</span>])</span><br><span class="line">VAL_HDF5 = path.sep.join([MX_OUTPUT, <span class="string">"hdf5/val.hdf5"</span>])</span><br><span class="line">TEST_HDF5 = path.sep.join([MX_OUTPUT, <span class="string">"hdf5/test.hdf5"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#define path for storing Mean R G B data</span></span><br><span class="line">DATASET_MEAN = path.sep.join([BASE_PATH, <span class="string">"output/car_mean.json"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># define the path to the output directory used for storing plots,</span></span><br><span class="line"><span class="comment"># classification reports, etc.</span></span><br><span class="line">OUTPUT_PATH = <span class="string">"output"</span></span><br><span class="line">MODEL_PATH = path.sep.join([OUTPUT_PATH,<span class="string">"inceptionv3_stanfordcar.hdf5"</span>])</span><br><span class="line">FIG_PATH = path.sep.join([OUTPUT_PATH,<span class="string">"inceptionv3_stanfordcar.png"</span>])</span><br><span class="line">JSON_PATH = path.sep.join([OUTPUT_PATH,<span class="string">"inceptionv3_stanfordcar.json"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># define the path to the label encoder</span></span><br><span class="line">LABEL_ENCODER_PATH = path.sep.join([BASE_PATH, <span class="string">"output/le.cpickle"</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># define the percentage of validation and testing images relative</span></span><br><span class="line"><span class="comment"># to the number of training images</span></span><br><span class="line">NUM_CLASSES = <span class="number">164</span></span><br><span class="line">NUM_VAL_IMAGES = <span class="number">0.15</span></span><br><span class="line">NUM_TEST_IMAGES = <span class="number">0.15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># define the batch size</span></span><br><span class="line">BATCH_SIZE = <span class="number">64</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®æ–‡ä»¶ä¸­åŒ…æ‹¬<code>HDF5</code>æ–‡ä»¶çš„å­˜æ”¾ä½ç½®æè¿°ï¼ŒåŸå§‹æ•°æ®å’Œæ•°æ®æè¿°æ–‡ä»¶è·¯å¾„ï¼ŒRGBå‡å€¼å­˜å‚¨ä½ç½®ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­è¾“å‡ºçš„å›¾åƒå’Œæ—¥å¿—å­˜å‚¨ä½ç½®ç­‰ä¿¡æ¯ã€‚</p>
<h3 id="æ•°æ®æ¦‚è§ˆ"><a href="#æ•°æ®æ¦‚è§ˆ" class="headerlink" title="æ•°æ®æ¦‚è§ˆ"></a>æ•°æ®æ¦‚è§ˆ</h3><ol>
<li>æˆ‘ä»¬å…ˆå°†æ•°æ®æè¿°æ–‡ä»¶<code>complete_dataset.csv</code>å¯¼å…¥ï¼Œäº†è§£ä¸‹æ•°æ®æ ¼å¼ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># loading image paths and labels</span></span><br><span class="line">df = pd.read_csv(config.LABELS_PATH)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">id</th>
<th>Image FileName</th>
<th>Make</th>
<th>Model</th>
<th>Vechicle Typle</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td>car_ims/000090.jpg</td>
<td>Acura</td>
<td>RL</td>
<td>Sedan</td>
<td>2012</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td>car_ims/000091.jpg</td>
<td>Acura</td>
<td>RL</td>
<td>Sedan</td>
<td>2012</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td>car_ims/000092.jpg</td>
<td>Acura</td>
<td>RL</td>
<td>Sedan</td>
<td>2012</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td>car_ims/000093.jpg</td>
<td>Acura</td>
<td>RL</td>
<td>Sedan</td>
<td>2012</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li><p>éå†æ–‡ä»¶åˆ—è¡¨ï¼Œå°†æ–‡ä»¶åœ°å€å’Œæ ·æœ¬æ ‡ç­¾åˆ†åˆ«è¿›è¡Œå­˜å‚¨ï¼Œåœ¨æœ¬å®éªŒä¸­å€¼ä½¿ç”¨äº†åˆ¶é€ å•†å’Œæ¬¾å¼ä¸¤ç§ç‰¹å¾ï¼Œæ‰€ä»¥æ„æˆåˆ†ç±»æ€»å…±æœ‰164ä¸ªï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">trainPaths = []</span><br><span class="line">trainLabels = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> id,name <span class="keyword">in</span> enumerate(df[<span class="string">"Image Filename"</span>]):</span><br><span class="line">    trainPaths.append(os.sep.join([config.IMAGES_PATH,name]))</span><br><span class="line">    trainLabels.append(<span class="string">"&#123;&#125;:&#123;&#125;"</span>.format(df.iloc[id][<span class="string">"Make"</span>], df.iloc[id][<span class="string">"Model"</span>]))</span><br><span class="line"><span class="comment">#Encoding labels to num</span></span><br><span class="line">le = LabelEncoder()</span><br><span class="line">trainLabels = le.fit_transform(trainLabels)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŒ‰ç…§70%ï¼Œ15%ï¼Œ15%åˆ‡åˆ†è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼š</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">numVal = int(len(trainPaths)*<span class="number">0.15</span>)</span><br><span class="line">numTest = int(len(trainPaths)*<span class="number">0.15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># perform sampling from the training set to construct a a validation set</span></span><br><span class="line">split = train_test_split(trainPaths, trainLabels, test_size=numVal,</span><br><span class="line">    stratify=trainLabels)</span><br><span class="line">(trainPaths, valPaths, trainLabels, valLabels) = split</span><br><span class="line"></span><br><span class="line"><span class="comment"># perform stratified sampling from the training set to construct a testing set</span></span><br><span class="line">split = train_test_split(trainPaths, trainLabels, test_size=numTest,</span><br><span class="line">    stratify=trainLabels)</span><br><span class="line">(trainPaths, testPaths, trainLabels, testLabels) = split</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆå§‹åŒ–ç›¸å…³é…ç½®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># initialize the lists of RGB channel averages</span></span><br><span class="line">(R, G, B) = ([], [], [])</span><br><span class="line"></span><br><span class="line"><span class="comment"># construct a list pairing the training, validation, and testing</span></span><br><span class="line"><span class="comment"># image paths along with their corresponding labels and output list</span></span><br><span class="line"><span class="comment"># files</span></span><br><span class="line">datasets = [</span><br><span class="line">	(<span class="string">"train"</span>, trainPaths, trainLabels, config.TRAIN_HDF5),</span><br><span class="line">	(<span class="string">"val"</span>, valPaths, valLabels, config.VAL_HDF5),</span><br><span class="line">	(<span class="string">"test"</span>, testPaths, testLabels, config.TEST_HDF5)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>éå†æ•°æ®é›†å¹¶å­˜å‚¨è‡³HDF5æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> HDF5DatasetWriter</span><br><span class="line"><span class="keyword">import</span> AspectAwarePreprocessor</span><br><span class="line"><span class="keyword">import</span> progressbar</span><br><span class="line"></span><br><span class="line"><span class="comment">#resize images to (256,256,3)</span></span><br><span class="line">aap = AspectAwarePreprocessor(<span class="number">256</span>,<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># loop over the dataset tuples</span></span><br><span class="line"><span class="keyword">for</span> (dType, paths, labels, outputPath) <span class="keyword">in</span> datasets:</span><br><span class="line">    <span class="comment"># create HDF5 writer</span></span><br><span class="line">    print(<span class="string">"[INFO] building &#123;&#125;..."</span>.format(outputPath))</span><br><span class="line">    writer = HDF5DatasetWriter((len(paths), <span class="number">256</span>, <span class="number">256</span>, <span class="number">3</span>), outputPath)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># initialize the progress bar</span></span><br><span class="line">    widgets = [<span class="string">"Building Dataset: "</span>, progressbar.Percentage(), <span class="string">" "</span>,</span><br><span class="line">        progressbar.Bar(), <span class="string">" "</span>, progressbar.ETA()]</span><br><span class="line">    pbar = progressbar.ProgressBar(maxval=len(paths),</span><br><span class="line">        widgets=widgets).start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># loop over the image paths</span></span><br><span class="line">    <span class="keyword">for</span> (i, (path, label)) <span class="keyword">in</span> enumerate(zip(paths, labels)):</span><br><span class="line">        <span class="comment"># load the image from disk</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            image = cv2.imread(path)</span><br><span class="line">            image = aap.preprocess(image)</span><br><span class="line">            <span class="comment">#print(image.shape)</span></span><br><span class="line">            <span class="comment"># if we are building the training dataset, then compute the</span></span><br><span class="line">            <span class="comment"># mean of each channel in the image, then update the respective lists</span></span><br><span class="line">            <span class="keyword">if</span> dType == <span class="string">"train"</span>:</span><br><span class="line">                (b, g, r) = cv2.mean(image)[:<span class="number">3</span>]</span><br><span class="line">                R.append(r)</span><br><span class="line">                G.append(g)</span><br><span class="line">                B.append(b)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># add the image and label to the HDF5 dataset</span></span><br><span class="line">            writer.add([image], [label])</span><br><span class="line">            pbar.update(i)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(path)</span><br><span class="line">            print(label)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># close the HDF5 writer</span></span><br><span class="line">    pbar.finish()</span><br><span class="line">    writer.close()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬é¦–å…ˆç»Ÿä¸€å°†æ–‡ä»¶è°ƒæ•´åˆ°(256,256,3)å¤§å°ï¼Œå†è¿›è¡Œå­˜å‚¨ï¼Œæ‰€ä»¥åœ¨è¯»å–æ–‡ä»¶ä¹‹åè¿›è¡Œäº†ç®€å•çš„é¢„å¤„ç†ã€‚</p>
</blockquote>
</li>
<li><p>å°†RGBå‡å€¼å­˜å‚¨è‡³å•ç‹¬æ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># construct a dictionary of averages, then serialize the means to a JSON file</span></span><br><span class="line">print(<span class="string">"[INFO] serializing means..."</span>)</span><br><span class="line">D = &#123;<span class="string">"R"</span>: np.mean(R), <span class="string">"G"</span>: np.mean(G), <span class="string">"B"</span>: np.mean(B)&#125;</span><br><span class="line">f = open(config.DATASET_MEAN, <span class="string">"w"</span>)</span><br><span class="line">f.write(json.dumps(D))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å°†å›¾åƒæ–‡ä»¶åˆ†ä¸ºä¸‰ä¸ªç±»åˆ«å¹¶åˆ†åˆ«å­˜åˆ°äº†ä¸‰ä¸ªHDF5æ–‡ä»¶ä¹‹ä¸­ã€‚</p>
<p>å…³äºHDF5æ–‡ä»¶å­˜å‚¨ç›¸å…³å†…å®¹ï¼Œè¯¦è§åç»­æ¨å‡ºçš„é¢„å¤„ç†åšå®¢~~</p>
<p>å¦‚æœä½¿ç”¨<code>MXNET</code>çš„listå’Œrecæ¥æ„å»ºæ•°æ®å­˜å‚¨é›†åˆï¼Œåœ¨ä¸Šè¿°æ­¥éª¤3çš„åŸºç¡€ä¸Šï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><p>æ„å»ºæ•°æ®é›†åˆ—è¡¨æ–‡ä»¶â€™.listâ€™æ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># construct a list pairing the training, validation, and testing</span></span><br><span class="line"><span class="comment"># image paths along with their corresponding labels and output list</span></span><br><span class="line"><span class="comment"># files</span></span><br><span class="line">datasets = [</span><br><span class="line">	(<span class="string">"train"</span>, trainPaths, trainLabels, config.TRAIN_MX_LIST),</span><br><span class="line">	(<span class="string">"val"</span>, valPaths, valLabels, config.VAL_MX_LIST),</span><br><span class="line">	(<span class="string">"test"</span>, testPaths, testLabels, config.TEST_MX_LIST)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># loop over the dataset tuples</span></span><br><span class="line"><span class="keyword">for</span> (dType, paths, labels, outputPath) <span class="keyword">in</span> datasets:</span><br><span class="line">	<span class="comment"># open the output file for writing</span></span><br><span class="line">	print(<span class="string">"[INFO] building &#123;&#125;..."</span>.format(outputPath))</span><br><span class="line">    </span><br><span class="line">	f = open(outputPath, <span class="string">"w"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># loop over each of the individual images + labels</span></span><br><span class="line">	<span class="keyword">for</span> (i, (path, label)) <span class="keyword">in</span> enumerate(zip(paths, labels)):</span><br><span class="line">		<span class="comment"># write the image index, label, and output path to file</span></span><br><span class="line">		row = <span class="string">"\t"</span>.join([str(i), str(label), path])</span><br><span class="line">		f.write(<span class="string">"&#123;&#125;\n"</span>.format(row))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># close the output file</span></span><br><span class="line">	f.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°†Labelåç§°åºåˆ—åŒ–å­˜å‚¨ï¼Œä¾¿äºåç»­è°ƒç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f = open(config.LABEL_ENCODER_PATH, <span class="string">"wb"</span>)</span><br><span class="line">f.write(pickle.dumps(le))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>3.åˆ©ç”¨MXNetå·¥å…·<code>im2rec</code>åˆ›å»ºè®°å½•æ–‡ä»¶</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ /dsvm/tools/mxnet/bin/im2rec ./raid/datasets/cars/lists/train.lst <span class="string">""</span> ./raid/datasets/cars/rec/train.rec resize=256 encoding=<span class="string">'.jpg'</span> quality=100</span><br><span class="line"></span><br><span class="line">$ /dsvm/tools/mxnet/bin/im2rec ./raid/datasets/cars/lists/test.lst <span class="string">""</span> ./raid/datasets/cars/rec/test.rec resize=256 encoding=<span class="string">'.jpg'</span> quality=100</span><br><span class="line"></span><br><span class="line">$ /dsvm/tools/mxnet/bin/im2rec ./raid/datasets/cars/lists/val.lst <span class="string">""</span> ./raid/datasets/cars/rec/val.rec resize=256 encoding=<span class="string">'.jpg'</span> quality=100</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="è®­ç»ƒè¿ç§»å­¦ä¹ ç½‘ç»œ"><a href="#è®­ç»ƒè¿ç§»å­¦ä¹ ç½‘ç»œ" class="headerlink" title="è®­ç»ƒè¿ç§»å­¦ä¹ ç½‘ç»œ"></a>è®­ç»ƒè¿ç§»å­¦ä¹ ç½‘ç»œ</h2><p>åœ¨è¿ç§»å­¦ä¹ çš„æ¨¡å‹é€‰æ‹©ä¸Šæˆ‘ä»¬é€‰æ‹©äº†åŸºäºKerasæä¾›çš„InceptionV3,å¯é€šè¿‡<a href="https://keras-cn.readthedocs.io/en/latest/other/application/">Keraså®˜æ–¹æ–‡æ¡£</a>äº†è§£æ›´å¤šä½¿ç”¨è¯´æ˜ã€‚ä¸‹è¡¨åˆ—å‡ºäº†åœ¨kerasä¸­å„æ¨¡å‹çš„è¡¨ç°ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>å¤§å°</th>
<th>Top1å‡†ç¡®ç‡</th>
<th>Top5å‡†ç¡®ç‡</th>
<th>å‚æ•°æ•°ç›®</th>
<th>æ·±åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>Xception</td>
<td>88MB</td>
<td>0.790</td>
<td>0.945</td>
<td>22,910,480</td>
<td>126</td>
</tr>
<tr>
<td>VGG16</td>
<td>528MB</td>
<td>0.715</td>
<td>0.901</td>
<td>138,357,544</td>
<td>23</td>
</tr>
<tr>
<td>VGG19</td>
<td>549MB</td>
<td>0.727</td>
<td>0.910</td>
<td>143,667,240</td>
<td>26</td>
</tr>
<tr>
<td>ResNet50</td>
<td>99MB</td>
<td>0.759</td>
<td>0.929</td>
<td>25,636,712</td>
<td>168</td>
</tr>
<tr>
<td><strong>InceptionV3</strong></td>
<td><strong>92MB</strong></td>
<td><strong>0.788</strong></td>
<td><strong>0.944</strong></td>
<td><strong>23,851,784</strong></td>
<td><strong>159</strong></td>
</tr>
<tr>
<td>IncetionResNetV2</td>
<td>215MB</td>
<td>0.804</td>
<td>0.953</td>
<td>55,873,736</td>
<td>572</td>
</tr>
<tr>
<td>MobileNet</td>
<td>17MB</td>
<td>0.665</td>
<td>0.871</td>
<td>4,253,864</td>
<td>88</td>
</tr>
</tbody>
</table>
</div>
<h3 id="æ•°æ®è¯»å…¥"><a href="#æ•°æ®è¯»å…¥" class="headerlink" title="æ•°æ®è¯»å…¥"></a>æ•°æ®è¯»å…¥</h3><p>è¾“å…¥è¯»å…¥è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬å‡ ä¸ªå…³é”®ä»»åŠ¡ï¼šè¯»å–RGBå‡å€¼æ–‡ä»¶ï¼Œå¯¹åŸå§‹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼šå›¾åƒæ‰£å–ã€æ•°æ®å¢å¼ºã€å»é€šé“å‡å€¼ã€çŸ©é˜µåŒ–ç­‰ã€‚</p>
<p>è¿™å—å†…å®¹ä¸æ˜¯æœ¬ç¯‡é‡ç‚¹ï¼Œåªèƒ½æŒ–å‘ç•™ç»™åç»­æ›´æ–°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># construct the training image generator for data augmentation</span></span><br><span class="line">aug = ImageDataGenerator(rotation_range=<span class="number">20</span>, zoom_range=<span class="number">0.15</span>,</span><br><span class="line">	width_shift_range=<span class="number">0.2</span>, height_shift_range=<span class="number">0.2</span>, shear_range=<span class="number">0.15</span>,</span><br><span class="line">	horizontal_flip=<span class="keyword">True</span>, fill_mode=<span class="string">"nearest"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load the RGB means for the training set</span></span><br><span class="line">means = json.loads(open(config.DATASET_MEAN).read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the image preprocessors</span></span><br><span class="line">sp = SimplePreprocessor(<span class="number">224</span>, <span class="number">224</span>)</span><br><span class="line">pp = PatchPreprocessor(<span class="number">224</span>, <span class="number">224</span>)</span><br><span class="line">mp = MeanPreprocessor(means[<span class="string">"R"</span>], means[<span class="string">"G"</span>], means[<span class="string">"B"</span>])</span><br><span class="line">iap = ImageToArrayPreprocessor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the training and validation dataset generators</span></span><br><span class="line">trainGen = HDF5DatasetGenerator(config.TRAIN_HDF5, <span class="number">64</span>, aug=aug,</span><br><span class="line">	preprocessors=[pp, mp, iap], classes=config.NUM_CLASSES)</span><br><span class="line">valGen = HDF5DatasetGenerator(config.VAL_HDF5, <span class="number">64</span>,</span><br><span class="line">	preprocessors=[sp, mp, iap], classes=config.NUM_CLASSES)</span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å‹è®¾è®¡"><a href="#æ¨¡å‹è®¾è®¡" class="headerlink" title="æ¨¡å‹è®¾è®¡"></a>æ¨¡å‹è®¾è®¡</h3><p>æ¨¡å‹è®¾è®¡è¿‡ç¨‹å‚è€ƒäº†Keraså®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„æ¼”ç¤ºï¼Œå¯¼å…¥æ²¡æœ‰topçš„é¢„è®­ç»ƒInceptionV3æ¨¡å‹ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.applications.inception_v3 <span class="keyword">import</span> InceptionV3</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, GlobalAveragePooling2D</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"></span><br><span class="line"><span class="comment"># load the Inception network, ensuring the head FC layer sets are left off</span></span><br><span class="line">baseModel = InceptionV3(weights=<span class="string">"imagenet"</span>, include_top=<span class="keyword">False</span>,</span><br><span class="line">                        input_tensor=Input(shape=(<span class="number">224</span>, <span class="number">224</span>, <span class="number">3</span>)))</span><br><span class="line"><span class="comment"># initialize the new head of the network, a set of FC layers</span></span><br><span class="line"><span class="comment"># followed by a softmax classifier</span></span><br><span class="line">x = baseModel.output</span><br><span class="line">x = GlobalAveragePooling2D()(x)</span><br><span class="line">x = Dense(<span class="number">1024</span>, activation=<span class="string">'relu'</span>)(x)</span><br><span class="line">headModel = Dense(config.NUM_CLASSES, activation=<span class="string">'softmax'</span>)(x)</span><br><span class="line"></span><br><span class="line">model = Model(inputs=baseModel.input, outputs=headModel)</span><br><span class="line"></span><br><span class="line"><span class="comment"># loop over all layers in the base model and freeze them so they</span></span><br><span class="line"><span class="comment"># will *not* be updated during the training process</span></span><br><span class="line"><span class="keyword">for</span> layer <span class="keyword">in</span> baseModel.layers:</span><br><span class="line">  layer.trainable = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compile our model (this needs to be done after our setting our</span></span><br><span class="line"><span class="comment"># layers to being non-trainable</span></span><br><span class="line">print(<span class="string">"[INFO] compiling model..."</span>)</span><br><span class="line">opt = SGD(lr=<span class="number">0.005</span>,momentum=<span class="number">0.9</span>)</span><br><span class="line">model.compile(loss=<span class="string">"categorical_crossentropy"</span>, optimizer=opt, metrics=[<span class="string">"accuracy"</span>])</span><br></pre></td></tr></table></figure>
<p>ç‰¹åˆ«æ³¨æ„åœ¨è¿ç§»å­¦ä¹ ä¸­ï¼Œç”±äºæ–°æ·»åŠ å¢çš„åˆå§‹æƒé‡æ˜¯éšæœºç”Ÿæˆçš„ï¼Œè€Œå‰é¢å¤§é‡ç½‘ç»œå‚æ•°å¹¶frozenä¹‹åä¸å†å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªé¢„æµ‹çš„è¿‡ç¨‹æ¥å­¦ä¹ å‚æ•°åˆ°ä¸€å®šæ°´å¹³ï¼Œéœ€è¦æ§åˆ¶å­¦ä¹ ç‡åœ¨ä¸€ä¸ªæ¯”è¾ƒå°çš„èŒƒå›´ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦åå¤å°è¯•è¯•é”™ã€‚</p>
<h3 id="è®­ç»ƒè¿‡ç¨‹ä¼˜åŒ–"><a href="#è®­ç»ƒè¿‡ç¨‹ä¼˜åŒ–" class="headerlink" title="è®­ç»ƒè¿‡ç¨‹ä¼˜åŒ–"></a>è®­ç»ƒè¿‡ç¨‹ä¼˜åŒ–</h3><p>è®­ç»ƒè¿‡ç¨‹å‚è€ƒäº†ã€ŠDeep Learning for Computer Vison with Pythonã€‹ä½œè€…ç»™å‡ºçš„<code>Ctrl+C</code>è®­ç»ƒæ–¹æ³•ï¼Œå¯ä»¥éšæ—¶ä¿å­˜è®­ç»ƒç°åœºï¼Œè°ƒæ•´è®­ç»ƒç‡ç»§ç»­è¿›è¡Œè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># construct the argument parse and parse the arguments</span></span><br><span class="line">ap = argparse.ArgumentParser()</span><br><span class="line">ap.add_argument(<span class="string">"-c"</span>, <span class="string">"--checkpoints"</span>, required=<span class="keyword">True</span>, help=<span class="string">"path to output checkpoint directory"</span>)</span><br><span class="line">ap.add_argument(<span class="string">"-m"</span>, <span class="string">"--model"</span>, type=str, help=<span class="string">"path to *specific* model checkpoint to load"</span>)</span><br><span class="line">ap.add_argument(<span class="string">"-s"</span>, <span class="string">"--start-epoch"</span>, type=int, default=<span class="number">0</span>, help=<span class="string">"epoch to restart training at"</span>)</span><br><span class="line">args = vars(ap.parse_args())</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the logging level and output file</span></span><br><span class="line">logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">	filename=<span class="string">"training_&#123;&#125;.log"</span>.format(args[<span class="string">"start_epoch"</span>]), filemode=<span class="string">"w"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> args[<span class="string">"model"</span>] <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line"><span class="comment"># load the VGG16 network, ensuring the head FC layer sets are left off</span></span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line">    <span class="comment">## å®ç°ä¸Šä¸€æ­¥éª¤çš„é¢„è®­ç»ƒæ¨¡å‹å®šä¹‰å’Œæ¨¡å‹é¢„çƒ­</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	print(<span class="string">"[INFO] loading &#123;&#125;..."</span>.format(args[<span class="string">"model"</span>]))</span><br><span class="line">	model = load_model(args[<span class="string">"model"</span>])</span><br><span class="line">	<span class="comment"># update the learning rate</span></span><br><span class="line">	print(<span class="string">"[INFO] old learning rate: &#123;&#125;"</span>.format(K.get_value(model.optimizer.lr)))</span><br><span class="line">	K.set_value(model.optimizer.lr, <span class="number">1e-3</span>)</span><br><span class="line">	print(<span class="string">"[INFO] new learning rate: &#123;&#125;"</span>.format(K.get_value(model.optimizer.lr)))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># construct the set of callbacks</span></span><br><span class="line">callbacks = [</span><br><span class="line">	EpochCheckpoint(args[<span class="string">"checkpoints"</span>], every=<span class="number">5</span>,</span><br><span class="line">		startAt=args[<span class="string">"start_epoch"</span>]),</span><br><span class="line">	TrainingMonitor(config.FIG_PATH, jsonPath=config.JSON_PATH,</span><br><span class="line">		startAt=args[<span class="string">"start_epoch"</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># train the network</span></span><br><span class="line">print(<span class="string">"[INFO] training network..."</span>)</span><br><span class="line">model.fit_generator(</span><br><span class="line">	trainGen.generator(),</span><br><span class="line">	steps_per_epoch=trainGen.numImages // config.BATCH_SIZE,</span><br><span class="line">	validation_data=valGen.generator(),</span><br><span class="line">	validation_steps=valGen.numImages // config.BATCH_SIZE,</span><br><span class="line">	epochs=<span class="number">100</span>,</span><br><span class="line">	max_queue_size=config.BATCH_SIZE * <span class="number">2</span>,</span><br><span class="line">	callbacks=callbacks, verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">deep learning for computer vision with python</a></li>
</ol>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-04-09T04:45:13.000Z">2018-04-09</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/åŠ¨æ‰‹å®è·µè¥/">åŠ¨æ‰‹å®è·µè¥</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    37 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 5528 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/04/09/Deep-Learning-Lab-Logo-Detection/">åŸºäºæœºå™¨è§†è§‰æŠ€æœ¯çš„å“ç‰ŒLOGOæ£€æµ‹</a>
            
        </h1>
        <div class="content">
            <p>åˆ©ç”¨Flickr LOGOæ•°æ®é›†è®­ç»ƒä¸€ä¸ªæ£€æµ‹å“ç‰ŒLOGOçš„ç½‘ç»œï¼Œå¯¹æœºå™¨è§†è§‰çš„ç‰©ä½“è¯†åˆ«æŠ€æœ¯è¿›è¡ŒéªŒè¯ã€‚</p>
<!-- excerpt -->
<p>@[toc]</p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ€è¿‘åœ¨åšä¸€ä¸ªåˆ©ç”¨æœºå™¨è§†è§‰æŠ€æœ¯è¿›è¡Œè¶…å¸‚ç‰©å“æ£€ç‚¹çš„é¡¹ç›®è°ƒç ”åˆ†æï¼Œéœ€è¦å…ˆå¯»æ‰¾ä¸€ä¸ªå¯è¡Œçš„æŠ€æœ¯æ–¹æ¡ˆéªŒè¯å¯è¡Œæ€§ï¼ŒFlickræä¾›çš„LOGOæ•°æ®é›†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å“ç‰ŒLOGOè¯†åˆ«ä¾‹å­ï¼Œæœ¬æ–‡è®°å½•åˆ©ç”¨Flickr LOGOæ•°æ®é›†è®­ç»ƒä¸€ä¸ªç‰©ä½“è¯†åˆ«çš„æ·±åº¦ç¥ç»ç½‘ç»œè¿‡ç¨‹ã€‚</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/b.gif" alt="b"></p>
<h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><p>Flickr LOGOæ•°æ®é›†æä¾›äº†ä¸‰ç§ä¸åŒç±»å‹çš„LOGOæ•°æ®é›†é›†åˆï¼Œåˆ†åˆ«ä¸º<a href="http://image.ntua.gr/iva/datasets/flickr_logos/">Flickr Logos 27 dataset</a>ï¼Œ<a href="http://www.multimedia-computing.de/flickrlogos/#flickrlogos47">Datasets: FlickrLogos-32</a>ä»¥åŠ<a href="http://www.multimedia-computing.de/flickrlogos/#flickrlogos47">Datasets: FlickrLogos-47</a>ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ¯ç§æ•°æ®é›†çš„ç»„æˆåŠæ•°æ®ç»“æ„ï¼š</p>
<ol>
<li><p><a href="http://image.ntua.gr/iva/datasets/flickr_logos/">Flickr Logos 27 dataset</a></p>
<ul>
<li><p>è®­ç»ƒé›†åŒ…å«27ä¸ªåˆ†ç±»çš„810å¼ æ ‡è®°ç…§ç‰‡ï¼Œæ¯ä¸ªåˆ†ç±»30å¼ ç…§ç‰‡</p>
</li>
<li><p>åˆ†æ•£é›†åŒ…å«4207å¼ logoå›¾ç‰‡</p>
</li>
<li><p>æµ‹è¯•é›†æœ‰270å¼ ç…§ç‰‡ï¼Œæ¯ä¸ªåˆ†ç±»5å¼ ç…§ç‰‡ï¼Œå¦å¤–æœ‰135å¼ åˆ†ç±»å¤–ç…§ç‰‡é›†</p>
</li>
<li><p>27ä¸ªåˆ†ç±»åŒ…æ‹¬ï¼šAdidas, Apple, BMW, Citroen, Coca Cola, DHL, Fedex, Ferrari, Ford, Google, Heineken, HP, McDonalds, Mini, Nbc, Nike, Pepsi, Porsche, Puma, Red Bull, Sprite, Starbucks, Intel, Texaco, Unisef, Vodafone and Yahoo.</p>
</li>
<li><p>ä¸‹è½½åœ°å€ï¼š<a href="http://image.ntua.gr/iva/datasets/flickr_logos/flickr_logos_27_dataset.tar.gz">ä¸‹è½½</a></p>
</li>
<li><p>æ•°æ®æ ¼å¼ï¼šä¸‹è½½æ–‡ä»¶å¤¹ä¸­æä¾›ä¸€ä¸ª<code>txt</code>æ–‡ä»¶ç”¨äºæè¿°æ¯ä¸ªæ–‡ä»¶ä¸­LOGOçš„åˆ†ç±»å’Œä½ç½®ä¿¡æ¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  FileName ClassName subset   Coordinatesï¼ˆx1 y1 x2 y2ï¼‰</span></span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">91</span> <span class="number">288</span> <span class="number">125</span> <span class="number">306</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">182</span> <span class="number">63</span> <span class="number">229</span> <span class="number">94</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">192</span> <span class="number">291</span> <span class="number">225</span> <span class="number">306</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">285</span> <span class="number">61</span> <span class="number">317</span> <span class="number">79</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">285</span> <span class="number">298</span> <span class="number">324</span> <span class="number">329</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">377</span> <span class="number">292</span> <span class="number">421</span> <span class="number">324</span> </span><br><span class="line"><span class="number">4763210295.j</span>pg Adidas 	<span class="number">1</span> 		<span class="number">383</span> <span class="number">55</span> <span class="number">416</span> <span class="number">76</span> </span><br><span class="line"><span class="number">1230939811.j</span>pg Adidas 	<span class="number">2</span> 		<span class="number">129</span> <span class="number">326</span> <span class="number">257</span> <span class="number">423</span> </span><br><span class="line"><span class="number">1230939811.j</span>pg Adidas 	<span class="number">2</span> 		<span class="number">137</span> <span class="number">336</span> <span class="number">243</span> <span class="number">395</span></span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/dataset1_bboxes.jpg" alt="dataset1_bboxes"></p>
</li>
</ul>
</li>
<li><p><a href="http://www.multimedia-computing.de/flickrlogos/#flickrlogos47">Flickr Logos 32/47 dataset</a></p>
<blockquote>
<p>FlickrLogos-32 was designed for logo retrieval and multi-class logo detection and object recognition. However, the annotations for object detection were often incomplete,since only the most prominent logo instances were labelled. </p>
<p>FlickrLogos-47 uses the same image corpus as FlickrLogos-32 but has been re-annotated specifically for the task of object detection and recognition. </p>
</blockquote>
<p>2.1 Flickr Logos-32</p>
<ul>
<li><p>32ä¸ªåˆ†ç±»åŒ…æ‹¬ï¼š <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/adidas.jpg">Adidas</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/aldi.jpg">Aldi</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/apple.jpg">Apple</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/becks.jpg">Becks</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/bmw.jpg">BMW</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/carlsberg.jpg">Carlsberg</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/chimay.jpg">Chimay</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/cocacola.jpg">Coca-Cola</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/corona.jpg">Corona</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/dhl.jpg">DHL</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/erdinger.jpg">Erdinger</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/esso.jpg">Esso</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/fedex.jpg">Fedex</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ferrari.jpg">Ferrari</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ford.jpg">Ford</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/fosters.jpg">Fosterâ€™s</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/google.jpg">Google</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/guinness.jpg">Guiness</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/heineken.jpg">Heineken</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/hp.jpg">HP</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/milka.jpg">Milka</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/nvidia.jpg">Nvidia</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/paulaner.jpg">Paulaner</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/pepsi.jpg">Pepsi</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/rittersport.jpg">Ritter Sport</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/shell.jpg">Shell</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/singha.jpg">Singha</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/starbucks.jpg">Starbucks</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/stellaartois.jpg">Stella Artois</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/texaco.jpg">Texaco</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/tsingtao.jpg">Tsingtao</a> and <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ups.jpg">UPS</a></p>
</li>
<li><p>æ•°æ®é›†è¢«åˆ’åˆ†ä¸ºP1,P2,P3ä¸‰ä¸ªå­é›†ï¼š</p>
</li>
</ul>
</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>Partition</th>
<th>Description</th>
<th>Images</th>
<th>#Images</th>
</tr>
</thead>
<tbody>
<tr>
<td>P1 (training set)</td>
<td>Hand-picked images</td>
<td>10 per class</td>
<td>320 images</td>
</tr>
<tr>
<td>P2 (validation set)</td>
<td>Images showing at least a single logo under various views</td>
<td>30 per class + 3000 non-logo images</td>
<td>3960 images</td>
</tr>
<tr>
<td>P3 (test set = query set)</td>
<td>Images showing at least a single logo under various views</td>
<td>30 per class + 3000 non-logo images</td>
<td>3960 images</td>
</tr>
<tr>
<td>/</td>
<td>/</td>
<td>/</td>
<td>8240 images</td>
</tr>
</tbody>
</table>
</div>
<pre><code>2.2 FlickrLogos-47
</code></pre><ul>
<li>47ä¸ªåˆ†ç±»åŒ…æ‹¬ï¼š<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/adidas.jpg">Adidas (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/adidas.jpg">Adidas (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/aldi.jpg">Aldi</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/apple.jpg">Apple</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/becks.jpg">Becks (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/becks.jpg">Becks (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/bmw.jpg">BMW</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/carlsberg.jpg">Carlsberg (Symbol)</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/carlsberg.jpg">Carlsberg (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/chimay.jpg">Chimay (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/chimay.jpg">Chimay (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/cocacola.jpg">Coca-Cola</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/corona.jpg">Corona (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/corona.jpg">Corona (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/dhl.jpg">DHL</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/erdinger.jpg">Erdinger (Symbol)</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/erdinger.jpg">Erdinger (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/esso.jpg">Esso (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/esso.jpg">Esso (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/fedex.jpg">Fedex</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ferrari.jpg">Ferrari</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ford.jpg">Ford</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/fosters.jpg">Fosterâ€™s (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/fosters.jpg">Fosterâ€™s (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/google.jpg">Google</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/guinness.jpg">Guiness (Symbol)</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/guinness.jpg">Guiness (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/heineken.jpg">Heineken</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/hp.jpg">HP</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/milka.jpg">Milka (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/milka.jpg">Milka (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/nvidia.jpg">Nvidia (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/nvidia.jpg">Nvidia (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/paulaner.jpg">Paulaner (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/paulaner.jpg">Paulaner (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/pepsi.jpg">Pepsi (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/pepsi.jpg">Pepsi (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/rittersport.jpg">Ritter Sport</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/shell.jpg">Shell</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/singha.jpg">Singha (Symbol)</a>,<a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/singha.jpg">Singha (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/starbucks.jpg">Starbucks</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/stellaartois.jpg">Stella Artois (Symbol)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/stellaartois.jpg">Stella Artois (Text)</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/texaco.jpg">Texaco</a>, <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/tsingtao.jpg">Tsingtao (Symbol)</a> <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/tsingtao.jpg">Tsingtao (Text)</a> and <a href="http://www.multimedia-computing.de/flickrlogos/images/classes-small/ups.jpg">UPS</a>.</li>
</ul>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul>
<li>Flickr Logoæ•°æ®é›†è™½ç„¶ç±»åˆ«æ•°ç›®ä¼—å¤šï¼Œä½†å…·ä½“åˆ°æ¯ä¸ªåˆ†ç±»æä¾›çš„æ ·æœ¬æ•°ç›®æœ‰é™ï¼Œåœ¨æ•°æ®é¢„å¤„ç†ç¯èŠ‚éœ€è¦é…åˆæ•°æ®å¢å¼ºæ‰‹æ®µæ¥æ‰©å……æ•°æ®é›†çš„æ•°ç›®ï¼›</li>
<li>å¦å¤–ä¹Ÿå¯ä»¥ä»¿ç…§è½¦ç‰Œè¯†åˆ«çš„æ–¹æ³•ï¼Œå°†æ‰£å–çš„LOGOå›¾åƒæ·»åŠ åˆ°ä¸åŒèƒŒæ™¯å™ªå£°çš„å›¾åƒä¸­ï¼Œç”Ÿæˆå¤šç§è®­ç»ƒæ•°æ®ï¼›</li>
<li>ç”±äºLOGOå›¾åƒåŒ…å«å›¾åƒç‰¹å¾æœ‰é™ï¼ŒåŒæ—¶æä¾›å°æ ·æœ¬æ•°æ®ï¼Œé€šè¿‡è¿ç§»å­¦ä¹ çš„æ–¹æ¡ˆåˆ©ç”¨ImageNetè®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œè¿ç§»å­¦ä¹ æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ï¼Œæœ¬æ–‡å°†å¯¹è¿™ç§æ–¹å¼è¿›è¡Œè®¨è®ºåŠå®ç°ï¼›</li>
<li>ä¸‰ç§æ•°æ®é›†é¢å‘ä¸åŒçš„åŠŸèƒ½ä¹Ÿè®¾è®¡éœ€æ±‚ï¼Œä»å›¾åƒè´¨é‡ä¸Šæ¥çœ‹Flickr-47è´¨é‡ç›¸å¯¹è¾ƒå¥½ï¼ŒåŒæ—¶åœ¨32åˆ†ç±»å’Œ47åˆ†ç±»ä¸­æä¾›äº†å¯¹å›¾åƒè¯­ä¹‰åˆ†å‰²çš„æ ‡å®šæ•°æ®ï¼›</li>
</ul>
<p>åœ¨æ¦‚è§ˆè¿‡ä»»åŠ¡æ•°æ®é›†ä¹‹åï¼Œæˆ‘ä»¬å°†æŒ‰ç…§æ·±åº¦å­¦ä¹ ä¸šåŠ¡å¤„ç†æµç¨‹ï¼Œé€æ­¥è¿›è¡Œæ•°æ®çš„é¢„å¤„ç†ã€æ¨¡å‹å‡†å¤‡ã€è®­ç»ƒå’ŒéªŒè¯ç­‰å·¥ä½œã€‚ä¸ºç®€åŒ–é—®é¢˜å¤„ç†éš¾åº¦ï¼Œæˆ‘ä»¬ä½¿ç”¨Flickr Logo -27æ¥è¿›è¡Œæœ¬æ¬¡å®éªŒã€‚</p>
<h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><p>æ•°æ®å‡†å¤‡ç¯èŠ‚ä¸»è¦ä½¿ç”¨å¦‚ä¸‹åŸºæœ¬çš„å·¥å…·å’Œåº“æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> patches</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> imutils</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li><code>numpy</code>ç”¨æ¥åšåŸºæœ¬çš„çŸ©é˜µå¤„ç†ï¼›</li>
<li><code>pandas</code>ç”¨äºè¯»å–å’Œåˆ†ææ•°æ®æè¿°æ–‡ä»¶ï¼›</li>
<li><code>matplotlib</code>ç”¨äºè¾…åŠ©æ˜¾ç¤ºé¢„å¤„ç†ç»“æœï¼›</li>
<li><code>cv2</code>æ˜¯opencvçš„pythonå°è£…ï¼Œè¿›è¡Œå›¾åƒè¯»å–ã€å›¾åƒåˆ†æç­‰æ“ä½œï¼›</li>
<li><code>imutils</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å›¾åƒå¤„ç†åº“ï¼Œå¯ä»¥æ»¡è¶³åŸºæœ¬çš„å›¾åƒå¤„ç†éœ€æ±‚</li>
</ul>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆæŸ¥çœ‹ä»flickr-27ä¸Šä¸‹è½½çš„æ–‡ä»¶<code>flickr_logos_27_dataset_training_set_annotation.txt</code>æ¥äº†è§£åŸºæœ¬çš„å›¾åƒæ•°æ®ä¿¡æ¯å’Œåˆ†ç±»ä¿¡æ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_csv(<span class="string">"./flickr_logos_27_dataset/flickr_logos_27_dataset_training_set_annotation.txt"</span>,sep=<span class="string">" "</span>, header=<span class="keyword">None</span>)</span><br><span class="line">df.drop(df.columns[<span class="number">-1</span>],axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line">df.columns=[<span class="string">"Name"</span>,<span class="string">"labels"</span>,<span class="string">"subset"</span>,<span class="string">"x1"</span>,<span class="string">"y1"</span>,<span class="string">"x2"</span>,<span class="string">"y2"</span>]</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">output:&gt;&gt;&gt;&gt;</span><br><span class="line">	     Name      labels subset      x1	y1	x2	y2</span><br><span class="line"><span class="number">0</span>	<span class="number">144503924.j</span>pg	Adidas	<span class="number">1</span>	<span class="number">38</span>	<span class="number">12</span>	<span class="number">234</span>	<span class="number">142</span></span><br><span class="line"><span class="number">1</span>	<span class="number">2451569770.j</span>pg	Adidas	<span class="number">1</span>	<span class="number">242</span>	<span class="number">208</span>	<span class="number">413</span>	<span class="number">331</span></span><br><span class="line"><span class="number">2</span>	<span class="number">390321909.j</span>pg	Adidas	<span class="number">1</span>	<span class="number">13</span>	<span class="number">5</span>	<span class="number">89</span>	<span class="number">60</span></span><br><span class="line"><span class="number">3</span>	<span class="number">4761260517.j</span>pg	Adidas	<span class="number">1</span>	<span class="number">43</span>	<span class="number">122</span>	<span class="number">358</span>	<span class="number">354</span></span><br><span class="line"><span class="number">4</span>	<span class="number">4763210295.j</span>pg	Adidas	<span class="number">1</span>	<span class="number">83</span>	<span class="number">63</span>	<span class="number">130</span>	<span class="number">93</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æè¿°æ–‡ä»¶ä¸­æ€»å…±æä¾›äº†4536æ¡è®°å½•ï¼Œè€Œå®é™…æä¾›çš„å›¾åƒæ–‡ä»¶åªæœ‰1000å¤šå¼ ï¼Œè¿™è¯´æ˜å¾ˆå¤šæ–‡ä»¶åŒ…æ‹¬ä¸æ­¢ä¸€ä¸ªLOGOã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">len(df)</span><br><span class="line">&gt;&gt;&gt;: <span class="number">4536</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>pandas</code>å¯¹æ–‡ä»¶è¿›è¡Œä¸€ä¸ªç®€å•çš„shuffleå¤„ç†ï¼Œä¾¿äºå¿«é€Ÿåˆ‡åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shuffle the datasets</span></span><br><span class="line">df = df.sample(frac=<span class="number">1</span>).reset_index(drop=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†å¿«é€ŸæŸ¥çœ‹æè¿°æ–‡ä»¶æä¾›çš„æ ‡è®°ä¿¡æ¯åœ¨å›¾åƒä¸­çš„æ˜¾ç¤ºæ•ˆæœï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥çœ‹ä¸€ä¸‹LOGOæ ‡è®°ä¿¡æ¯çš„æ•ˆæœï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_image</span><span class="params">(id)</span>:</span></span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    image = os.path.join(<span class="string">"./flickr_logos_27_dataset/flickr_logos_27_dataset_images/"</span>,df.loc[id][<span class="string">"Name"</span>])</span><br><span class="line">    image = cv2.imread(image)</span><br><span class="line">    plt.figure(<span class="number">8</span>)</span><br><span class="line">    plt.imshow(image)</span><br><span class="line">    currentAxis=plt.gca()</span><br><span class="line">    rect=patches.Rectangle((df[<span class="string">"x1"</span>].iloc[id], df[<span class="string">"y1"</span>].iloc[id]),</span><br><span class="line">                           df[<span class="string">"x2"</span>].iloc[id]-df[<span class="string">"x1"</span>].iloc[id],</span><br><span class="line">                           df[<span class="string">"y2"</span>].iloc[id]-df[<span class="string">"y1"</span>].iloc[id],</span><br><span class="line">                           linewidth=<span class="number">2</span>,edgecolor=<span class="string">'r'</span>,facecolor=<span class="string">'none'</span>)</span><br><span class="line">    currentAxis.add_patch(rect)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å…¶ä¸­ç”¨åˆ°äº†<code>plt.gca()</code>å’Œmatplotlibçš„<code>patches</code>å‡½æ•°ç”¨äºå›¾åƒçš„å åŠ æ˜¾ç¤ºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨<code>cv2.rectangle</code>å‡½æ•°</p>
</blockquote>
<p>éšæœºæŸ¥çœ‹ä¸€ä¸ªæ ‡è®°åœ¨å›¾åƒä¸­çš„æ˜¾ç¤ºæ•ˆæœ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">id = random.randint(<span class="number">0</span>,len(df))</span><br><span class="line">show_image(id)</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/BMW_sample.png" alt="BMW_sample"></p>
<p>ä¸‹é¢éœ€è¦å†™ä¸€ä¸ªæŠ å›¾ç¨‹åºï¼ŒæŠŠæ‰€æœ‰LOGOä»åŸå§‹å›¾åƒä¸­æ‰£å–å‡ºæ¥ï¼Œå½¢æˆè®­ç»ƒç”¨æ•°æ®é›†ï¼Œåœ¨ä¿å­˜å›¾åƒä¹‹å‰è¿›è¡Œå›¾åƒç®€å•çš„é¢„å¤„ç†å’Œè°ƒæ•´å½¢çŠ¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crop_img</span><span class="params">(id)</span>:</span></span><br><span class="line">    image = os.path.join(<span class="string">"./flickr_logos_27_dataset/flickr_logos_27_dataset_images/"</span>,df.loc[id][<span class="string">"Name"</span>])</span><br><span class="line">    image = cv2.imread(image)</span><br><span class="line">    crop_image = image[df[<span class="string">"y1"</span>].iloc[id]:df[<span class="string">"y2"</span>].iloc[id],df[<span class="string">"x1"</span>].iloc[id]:df[<span class="string">"x2"</span>].iloc[id]]</span><br><span class="line">    <span class="keyword">return</span> crop_image</span><br><span class="line">  </span><br><span class="line">WIDTH = <span class="number">64</span></span><br><span class="line">HEIGHT = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> id, name <span class="keyword">in</span> enumerate(df[<span class="string">"Name"</span>]):</span><br><span class="line">    cropped_image = crop_img(id)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resized_image = cv2.resize(cropped_image, 	     </span><br><span class="line">                                   (WIDTH,HEIGHT),interpolation=cv2.INTER_CUBIC)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(id)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    image_name = str(id)+<span class="string">"_"</span>+df.iloc[id][<span class="string">"labels"</span>]+<span class="string">".jpg"</span></span><br><span class="line">    cv2.imwrite(os.path.join(<span class="string">"./flickr_logos_27_dataset/cropped/"</span>,image_name),resized_image)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨å›¾åƒæ‰£å–è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>ç”±äºæè¿°é—®é¢˜æä¾›çš„ä¿¡æ¯æœ¬èº«çš„é—®é¢˜ï¼Œæœ‰ä¸€äº›å¼‚å¸¸æ•°æ®éœ€è¦å‰”é™¤ï¼Œæ¯”å¦‚æœ‰5æ¡è®°å½•æä¾›çš„x1=x2,æˆ–y1=y2ï¼Œå³åœ¨åŸå§‹å›¾åƒä¸Šæ²¡æœ‰è¿›è¡Œæ ‡è®°ï¼›</li>
<li>å›¾åƒç¼©æ”¾å…¶å®ä¸åº”è¯¥é‡‡ç”¨è¿™ç§å‚»ç“œçš„å‹ç¼©æ–¹å¼ï¼Œåº”è¯¥å°½é‡æ§åˆ¶é•¿å®½æ¯”ï¼Œä¿è¯ä¸äº§ç”Ÿæ˜æ˜¾çš„å½¢å˜ï¼›</li>
</ol>
</blockquote>
<p>å¤„ç†å®Œæˆä¹‹åï¼Œæ‰£å–å›¾åƒå°†åœ¨<code>cropped</code>æ–‡ä»¶å¤¹ä¸­ä»¥<code>{id}_{label}.jpg</code>çš„æ–‡ä»¶åå­˜å‚¨ã€‚</p>
<p>å›¾åƒæ‰£å–ä¹‹åï¼Œé€šè¿‡äººå·¥æ ¸å¯¹ï¼Œæˆ‘ä»¬å‘ç°ä»ç„¶å­˜åœ¨ä¸€äº›æ˜æ˜¾æœ‰é—®é¢˜çš„å›¾åƒï¼Œæ¯”å¦‚å¤šå¼ pumaçš„å›¾åƒï¼Œå…¶å®å­˜åœ¨æ˜æ˜¾çš„æ ‡è®°é—®é¢˜ï¼Œéœ€è¦ä»æ•°æ®é›†ä¸­å‰”é™¤ï¼š</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/puma_error_img.png" alt="puma_error_img"></p>
<h3 id="æ•°æ®é›†åˆ‡åˆ†"><a href="#æ•°æ®é›†åˆ‡åˆ†" class="headerlink" title="æ•°æ®é›†åˆ‡åˆ†"></a>æ•°æ®é›†åˆ‡åˆ†</h3><p>æˆ‘ä»¬å°†æ‰£å–æ•°æ®è¯»å…¥è¿›è¡Œç®€å•é¢„å¤„ç†å’Œæ•°æ®åˆ‡åˆ†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = []</span><br><span class="line">labels = []</span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> os.listdir(<span class="string">"./flickr_logos_27_dataset/cropped/"</span>):</span><br><span class="line">    img_file = cv2.imread(os.path.join(<span class="string">"./flickr_logos_27_dataset/cropped/"</span>,img))</span><br><span class="line">    data.append(img_file)</span><br><span class="line">    labels.append(img.split(<span class="string">"_"</span>)[<span class="number">1</span>].split(<span class="string">"."</span>)[<span class="number">0</span>])</span><br><span class="line">data = np.stack(data)</span><br><span class="line">labels = np.stack(labels)</span><br><span class="line"></span><br><span class="line">data = data/<span class="number">255</span></span><br></pre></td></tr></table></figure>
<p>å°†æ ‡ç­¾æ•°æ®è½¬å˜æˆOneHotçŸ©é˜µï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelBinarizer</span><br><span class="line">le = LabelBinarizer()</span><br><span class="line">labels = le.fit_transform(labels)</span><br></pre></td></tr></table></figure>
<p>åˆ‡åˆ†æ•°æ®é›†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X,testX,y,testy = train_test_split(data, labels,test_size=<span class="number">0.1</span>,stratify=labels,random_state=<span class="number">42</span> )</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®å¢å¼º"><a href="#æ•°æ®å¢å¼º" class="headerlink" title="æ•°æ®å¢å¼º"></a>æ•°æ®å¢å¼º</h3><p>æ•°æ®å¢å¼ºæ˜¯å›¾åƒå¤„ç†ä¸­ç»å¸¸é‡‡ç”¨çš„ä¸€ç§æ•°æ®å¤„ç†æ–¹å¼ï¼Œç”±äºæ¶‰åŠå†…å®¹è¾ƒå¤šï¼Œåœ¨æœ¬ç¯‡å®æˆ˜ä¸­ä¸å•ç‹¬å±•å¼€ï¼Œä»…æŠŠåˆ©ç”¨Kerasæ•°æ®å¢å¼ºå·¥å…·<code>ImageDataGenerator</code>çš„æ–¹æ³•æä¾›ä¸€ä¸‹ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.preprocessing.image import ImageDataGenerator </span><br><span class="line"><span class="comment"># construct the training image generator for data augmentation</span></span><br><span class="line">aug = ImageDataGenerator(<span class="attribute">rotation_range</span>=18, <span class="attribute">zoom_range</span>=0.15,</span><br><span class="line">	<span class="attribute">width_shift_range</span>=0.2, <span class="attribute">height_shift_range</span>=0.2, <span class="attribute">shear_range</span>=0.15,</span><br><span class="line">	<span class="attribute">horizontal_flip</span>=<span class="literal">True</span>, <span class="attribute">fill_mode</span>=<span class="string">"nearest"</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">gen_flow</span>=aug.flow(X, y,<span class="attribute">batch_size</span>=64,seed=0)</span><br><span class="line"><span class="attribute">validation</span>=aug.flow(testX,testy,batch_size=32,seed=0)</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹å®šä¹‰"><a href="#æ¨¡å‹å®šä¹‰" class="headerlink" title="æ¨¡å‹å®šä¹‰"></a>æ¨¡å‹å®šä¹‰</h2><p>æ ¹æ®å‰æ–‡å¯¹æ•°æ®çš„åˆ†æï¼Œæˆ‘ä»¬åˆ†åˆ«é‡‡å–ä¸¤ç§æ–¹å¼è®¾è®¡ç½‘ç»œæ¨¡å‹ï¼šä»å¤´è®­ç»ƒä¸€ä¸ªæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œå’Œåˆ©ç”¨è¿ç§»å­¦ä¹ Fine-Tuneä¸€ä¸ªæ»¡è¶³éœ€æ±‚çš„ç½‘ç»œæ¨¡å‹ã€‚</p>
<h3 id="ä»å¤´è®­ç»ƒä¸€ä¸ªç½‘ç»œæ¨¡å‹"><a href="#ä»å¤´è®­ç»ƒä¸€ä¸ªç½‘ç»œæ¨¡å‹" class="headerlink" title="ä»å¤´è®­ç»ƒä¸€ä¸ªç½‘ç»œæ¨¡å‹"></a>ä»å¤´è®­ç»ƒä¸€ä¸ªç½‘ç»œæ¨¡å‹</h3><p>ç”±äºé—®é¢˜æœ¬è´¨æ˜¯ä¸€ä¸ªç‰©ä½“è¯†åˆ«ä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨å®ç°ä¸Šåº”è¯¥åŒ…æ‹¬å›¾åƒåˆ†ç±»å’Œå®šä½çš„å›å½’ä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–é—®é¢˜é€šè¿‡ä¸€ä¸ªæ»‘åŠ¨çª—å£æ¥å¯¹è¾“å…¥å›¾åƒè¿›è¡Œæ‰«æï¼Œç„¶åé’ˆå¯¹æ¯ä¸ªæ‰«æçª—å£è¿›è¡Œå›¾åƒåˆ†ç±»ã€‚</p>
<blockquote>
<p>å½“ç„¶å®é™…è¿‡ç¨‹ä¸­ï¼Œé—®é¢˜è¦è¿œæ¯”è¿™å¤æ‚ï¼Œå¾ˆéš¾é€‰æ‹©åˆé€‚çš„æ»‘åŠ¨çª—å£å¤§å°é€‚ç”¨ç°å®å›¾åƒçš„éœ€æ±‚ï¼Œæ‰€ä»¥åœ¨ä¸»æµçš„ç‰©ä½“è¯†åˆ«æ¨¡å‹ä¸­ä¸€èˆ¬éƒ½é‡‡ç”¨å¤šç§ä¸åŒå¤§å°çš„Anchor boxæ¥å›å½’å›¾åƒçš„ä½ç½®ã€‚</p>
</blockquote>
<p>ç”±äºLOGOæ¯å¼ å›¾åƒåŒ…å«ç‰¹å¾æœ‰é™ï¼Œæˆ‘ä»¬åœ¨æœ¬æ¬¡å®éªŒä¸­åˆ©ç”¨<strong>LeNet</strong>çš„æ¶æ„ï¼Œè®¾è®¡äº†ä¸€ä¸ªç®€å•çš„å·ç§¯ç½‘ç»œæ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/model.png" alt="model"></p>
<p>æ¨¡å‹ä¸»ä½“åˆ©ç”¨ä¸‰ä¸ª<code>CONV =&gt; RELU =&gt; POOL</code>ç»“æ„æ¥æŠ½å–å›¾åƒç‰¹å¾ï¼Œæœ€ååˆ©ç”¨å…¨è”é€šç½‘ç»œ+Softmaxåˆ†ç±»å™¨æ¥è·å¾—æœ€ç»ˆ27ç±»åˆ†ç±»ç»“æœã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers.convolutional <span class="keyword">import</span> Conv2D</span><br><span class="line"><span class="keyword">from</span> keras.layers.convolutional <span class="keyword">import</span> MaxPooling2D</span><br><span class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Activation</span><br><span class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Flatten</span><br><span class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Dense</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">inputShape = (HEIGHT, WIDTH, <span class="number">3</span>)</span><br><span class="line">        <span class="comment"># first set of CONV =&gt; RELU =&gt; POOL layers</span></span><br><span class="line">model.add(Conv2D(<span class="number">16</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">"same"</span>,input_shape=inputShape))</span><br><span class="line">model.add(Activation(<span class="string">"relu"</span>))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>), strides=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># second set of CONV =&gt; RELU =&gt; POOL layers</span></span><br><span class="line">model.add(Conv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">"same"</span>))</span><br><span class="line">model.add(Activation(<span class="string">"relu"</span>))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>), strides=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># third set of CONV =&gt; RELU =&gt; POOL layers</span></span><br><span class="line">model.add(Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">"same"</span>))</span><br><span class="line">model.add(Activation(<span class="string">"relu"</span>))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>), strides=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># first (and only) set of FC =&gt; RELU layers</span></span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(<span class="number">500</span>))</span><br><span class="line">model.add(Activation(<span class="string">"relu"</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.25</span>))</span><br><span class="line"><span class="comment"># softmax classifier</span></span><br><span class="line">model.add(Dense(len(CLASSNAME)))</span><br><span class="line">model.add(Activation(<span class="string">"softmax"</span>))</span><br></pre></td></tr></table></figure>
<p>å®šä¹‰ç›®æ ‡ä¼˜åŒ–å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.optimizers <span class="keyword">import</span> Adam,SGD,RMSprop</span><br><span class="line">opt = RMSprop(lr=<span class="number">0.001</span>, rho=<span class="number">0.9</span>)</span><br><span class="line">model.compile(loss=<span class="string">"categorical_crossentropy"</span>, optimizer=opt,metrics=[<span class="string">"accuracy"</span>])</span><br></pre></td></tr></table></figure>
<p>è¿­ä»£è®­ç»ƒ100ä¸ªepoch:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">history=model.fit_generator(</span><br><span class="line">	gen_flow,</span><br><span class="line">	steps_per_epoch=len(X) // <span class="number">32</span>,</span><br><span class="line">	validation_data=aug.flow(testX,testy,batch_size=<span class="number">32</span>,seed=<span class="number">0</span>),</span><br><span class="line">	validation_steps=len(testX) // <span class="number">32</span>,</span><br><span class="line">	epochs=<span class="number">100</span>,</span><br><span class="line">	verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>100è½®ä¹‹åï¼ŒéªŒè¯é›†è¾¾åˆ°äº†99.89%çš„å‡†ç¡®ç‡ï¼ŒåŸºæœ¬æ»¡è¶³äº†è¦æ±‚ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­è®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®çš„å‡†ç¡®ç‡åŠLosså˜åŒ–è¯¦è§ä¸‹å›¾ï¼š</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/accuracy_curve.png" alt="accuracy_curve"></p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/loss_curve.png" alt="loss_curve"></p>
<h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize = (<span class="number">15</span>,<span class="number">40</span>))</span><br><span class="line"><span class="keyword">for</span> i,test_img <span class="keyword">in</span> enumerate(os.listdir(<span class="string">"./test"</span>)):</span><br><span class="line">    img = cv2.imread(os.path.join(<span class="string">"./test"</span>,test_img))</span><br><span class="line">    img = cv2.resize(img, (WIDTH,HEIGHT),interpolation=cv2.INTER_CUBIC)</span><br><span class="line">    img = np.expand_dims(img,axis=<span class="number">0</span>)</span><br><span class="line">    result = model.predict(img)</span><br><span class="line">    result = le.inverse_transform(result)</span><br><span class="line">    plt.subplot(<span class="number">8</span>,<span class="number">4</span>, i+<span class="number">1</span>)</span><br><span class="line">    img = cv2.cvtColor(img[<span class="number">0</span>],  cv2.COLOR_BGR2RGB)</span><br><span class="line">    plt.imshow(img)</span><br><span class="line">    plt.title(<span class="string">'pred:'</span> + str(result[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/test_result.png" alt="test_result"></p>
<h3 id="è®¾è®¡æ»‘åŠ¨çª—å£å’Œç‰¹å¾é‡‘å­—å¡”"><a href="#è®¾è®¡æ»‘åŠ¨çª—å£å’Œç‰¹å¾é‡‘å­—å¡”" class="headerlink" title="è®¾è®¡æ»‘åŠ¨çª—å£å’Œç‰¹å¾é‡‘å­—å¡”"></a>è®¾è®¡æ»‘åŠ¨çª—å£å’Œç‰¹å¾é‡‘å­—å¡”</h3><p>å…¶ä¸­æ»‘åŠ¨çª—å£ç”¨æ¥éå†å›¾åƒï¼Œç‰¹å¾é‡‘å­—å¡”ç”¨äºå®ç°å›¾åƒçš„å¤šå°ºåº¦å˜æ¢ï¼Œä¿è¯å¤šç§ä¸åŒå¤§å°çš„LOGOéƒ½å¯ä»¥è¢«å‡†ç¡®è¯†åˆ«ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sliding_window</span><span class="params">(image, step, ws)</span>:</span></span><br><span class="line">	<span class="comment"># slide a window across the image</span></span><br><span class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>, image.shape[<span class="number">0</span>] - ws[<span class="number">1</span>], step):</span><br><span class="line">		<span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, image.shape[<span class="number">1</span>] - ws[<span class="number">0</span>], step):</span><br><span class="line">			<span class="comment"># yield the current window</span></span><br><span class="line">			<span class="keyword">yield</span> (x, y, image[y:y + ws[<span class="number">1</span>], x:x + ws[<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_pyramid</span><span class="params">(image, scale=<span class="number">1.5</span>, minSize=<span class="params">(<span class="number">64</span>, <span class="number">64</span>)</span>)</span>:</span></span><br><span class="line">	<span class="comment"># yield the original image</span></span><br><span class="line">	<span class="keyword">yield</span> image</span><br><span class="line"></span><br><span class="line">	<span class="comment"># keep looping over the image pyramid</span></span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">		<span class="comment"># compute the dimensions of the next image in the pyramid</span></span><br><span class="line">		w = int(image.shape[<span class="number">1</span>] / scale)</span><br><span class="line">		image = imutils.resize(image, width=w)</span><br><span class="line"></span><br><span class="line">		<span class="comment"># if the resized image does not meet the supplied minimum</span></span><br><span class="line">		<span class="comment"># size, then stop constructing the pyramid</span></span><br><span class="line">		<span class="keyword">if</span> image.shape[<span class="number">0</span>] &lt; minSize[<span class="number">1</span>] <span class="keyword">or</span> image.shape[<span class="number">1</span>] &lt; minSize[<span class="number">0</span>]:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">		<span class="comment"># yield the next image in the pyramid</span></span><br><span class="line">		<span class="keyword">yield</span> image</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>ç‰¹å¾é‡‘å­—å¡”</strong>ï¼š</p>
<p>ä¸ºäº†æ£€æµ‹ä¸åŒå°ºåº¦çš„ç›®æ ‡ï¼Œä¾æ¬¡å°†åŸå›¾æŒ‰æ¯”ä¾‹ç¼©æ”¾å¹¶é€å…¥ç½‘ç»œã€‚ç¼ºç‚¹æ˜¯éœ€è¦å¤šæ¬¡resizeå›¾åƒï¼Œç¹çè€—æ—¶ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å®šä¹‰äº†è¾“å…¥å›¾åƒçš„å°ºå¯¸ä¸º(150,150)ï¼Œæ»‘åŠ¨çª—å£å¤§å°ä¸æˆ‘ä»¬å‰é¢è®­ç»ƒçš„åˆ†ç±»ç½‘ç»œçš„è¾“å…¥ä¸€è‡´ä¸º(64,64),ç‰¹å¾é‡‘å­—å¡”çš„ç¼©å°æ¯”ä¾‹ä¸º1.5å€ï¼Œè¿™æ ·å°†åœ¨åŸå§‹å›¾åƒåŸºç¡€ä¸Šè¿›è¡Œä¸¤æ¬¡ç¼©æ”¾ï¼›å¦å¤–å®šä¹‰äº†æ»‘åŠ¨çª—å£çš„æ­¥é•¿ä¸º16ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># initialize variables used for the object detection procedure</span></span><br><span class="line">INPUT_SIZE = (<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">PYR_SCALE = <span class="number">1.5</span></span><br><span class="line">WIN_STEP = <span class="number">16</span></span><br><span class="line">ROI_SIZE = (<span class="number">64</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">labels = &#123;&#125;</span><br><span class="line">CLASS_NAMES = list(lb.classes_)</span><br></pre></td></tr></table></figure>
<p>ä¸ºç®€åŒ–åç»­åˆ†æï¼Œå®šä¹‰ä¸€ä¸ªé¢„æµ‹å‡½æ•°ï¼Œç”¨äºè¿”å›å›¾åƒä¸­é¢„æµ‹å‡†ç¡®ç‡è¶…è¿‡minProbçª—å£åŠå¯¹è±¡åˆ†ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logo_prediction</span><span class="params">(model, batchROIs, batchLocs, labels, minProb=<span class="number">0.5</span>,dims=<span class="params">(<span class="number">64</span>, <span class="number">64</span>)</span>)</span>:</span></span><br><span class="line">    preds = model.predict(batchROIs)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(preds)):</span><br><span class="line">        prob = np.max(preds[i])</span><br><span class="line">        <span class="keyword">if</span> prob &gt; <span class="number">0.5</span>:</span><br><span class="line">            index = np.argmax(preds[i])</span><br><span class="line">            label = CLASS_NAMES[int(index)]</span><br><span class="line">            <span class="comment"># grab the coordinates of the sliding window for</span></span><br><span class="line">            <span class="comment"># the prediction and construct the bounding box</span></span><br><span class="line">            (pX, pY) = batchLocs[i]</span><br><span class="line">            box = (pX, pY, pX + dims[<span class="number">0</span>], pY + dims[<span class="number">1</span>])</span><br><span class="line">            L = labels.get(label, [])</span><br><span class="line">            L.append((box,prob))</span><br><span class="line">            labels[label] = L</span><br><span class="line">    <span class="keyword">return</span> labels</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†éå†æ¯ä¸ªç‰¹å¾é‡‘å­—å¡”å’Œæ¯ä¸ªæ»‘åŠ¨çª—å£ï¼Œå¯¹è¯†åˆ«ç»“æœè¿›è¡Œé¢„æµ‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">img_file = <span class="string">"./test/2.jpg"</span></span><br><span class="line">orig = cv2.imread(img_file)</span><br><span class="line"><span class="comment"># resize the input image to be a square</span></span><br><span class="line">resized = cv2.resize(orig, INPUT_SIZE, interpolation=cv2.INTER_CUBIC)</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the batch ROIs and (x, y)-coordinates</span></span><br><span class="line">batchROIs = <span class="keyword">None</span></span><br><span class="line">batchLocs = []</span><br><span class="line"><span class="comment"># loop over the image pyramid</span></span><br><span class="line"><span class="keyword">for</span> image <span class="keyword">in</span> image_pyramid(resized, scale=PYR_SCALE,minSize=ROI_SIZE):</span><br><span class="line">    <span class="comment"># loop over the sliding window locations</span></span><br><span class="line">    <span class="keyword">for</span> (x, y, roi) <span class="keyword">in</span> sliding_window(resized, WIN_STEP, ROI_SIZE):</span><br><span class="line">        <span class="comment"># take the ROI and pre-process it so we can later classify the</span></span><br><span class="line">        <span class="comment"># region with Keras</span></span><br><span class="line">        <span class="comment">#roi = img_to_array(roi)</span></span><br><span class="line">        roi = roi/<span class="number">255</span></span><br><span class="line">        roi = np.expand_dims(roi, axis=<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># roi = imagenet_utils.preprocess_input(roi)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if the batch is None, initialize it</span></span><br><span class="line">        <span class="keyword">if</span> batchROIs <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            batchROIs = roi</span><br><span class="line"></span><br><span class="line">        <span class="comment"># otherwise, add the ROI to the bottom of the batch</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            batchROIs = np.vstack([batchROIs, roi])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># add the (x, y)-coordinates of the sliding window to the batch</span></span><br><span class="line">        batchLocs.append((x, y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># classify the batch, then reset the batch ROIs and</span></span><br><span class="line">    <span class="comment"># (x, y)-coordinates</span></span><br><span class="line">    model.predict(batchROIs)</span><br><span class="line">    labels = logo_prediction(model, batchROIs, batchLocs,labels, minProb=<span class="number">0.9</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“è¿›è¡Œåˆ°è¿™æ­¥éª¤æ‰çªç„¶å‘ç°è®­ç»ƒåˆ†ç±»ä¸­ç¼ºäº†ä¸€ä¸ªå¾ˆé‡è¦çš„èƒŒæ™¯åˆ†ç±»ï¼Œå°†å¯¼è‡´åœ¨èƒŒæ™¯ä¸Šå¾ˆå¤šä¿¡æ¯çš„é¢„æµ‹ä¼šå‡ºé—®é¢˜ï¼Œåç»­ç­‰æ•´äº›èƒŒæ™¯å›¾ç‰‡å†é‡æ–°è®­ç»ƒç½‘ç»œï¼ŒğŸ˜­</p>
</blockquote>
<p>æœ€åä¸€æ­¥æ˜¯é¢„æµ‹ç»“æœçš„<strong>æå¤§å€¼æŠ‘åˆ¶</strong>å’Œæ˜¾ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imutils.object_detection <span class="keyword">import</span> non_max_suppression</span><br><span class="line"><span class="comment"># loop over the labels for each of detected objects in the image</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> labels.keys():</span><br><span class="line">	<span class="comment"># clone the input image so we can draw on it</span></span><br><span class="line">	clone = resized.copy()</span><br><span class="line"></span><br><span class="line">	<span class="comment"># loop over all bounding boxes for the label and draw them on the image</span></span><br><span class="line">	<span class="keyword">for</span> (box, prob) <span class="keyword">in</span> labels[k]:</span><br><span class="line">		(xA, yA, xB, yB) = box</span><br><span class="line">		cv2.rectangle(clone, (xA, yA), (xB, yB), (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># grab the bounding boxes and associated probabilities for each</span></span><br><span class="line">	<span class="comment"># detection, then apply non-maxima suppression to suppress</span></span><br><span class="line">	<span class="comment"># weaker, overlapping detections</span></span><br><span class="line">	boxes = np.array([p[<span class="number">0</span>] <span class="keyword">for</span> p <span class="keyword">in</span> labels[k]])</span><br><span class="line">	proba = np.array([p[<span class="number">1</span>] <span class="keyword">for</span> p <span class="keyword">in</span> labels[k]])</span><br><span class="line">	boxes = non_max_suppression(boxes, proba)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># loop over the bounding boxes again, this time only drawing the</span></span><br><span class="line">	<span class="comment"># ones that were *not* suppressed</span></span><br><span class="line">	<span class="keyword">for</span> (xA, yA, xB, yB) <span class="keyword">in</span> boxes:</span><br><span class="line">		cv2.rectangle(clone, (xA, yA), (xB, yB), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># show the output image</span></span><br><span class="line">	print(<span class="string">"[INFO] &#123;&#125;: &#123;&#125;"</span>.format(k, len(boxes)))</span><br><span class="line">	plt.imshow(clone)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æå¤§å€¼æŠ‘åˆ¶æ˜¯ç‰©ä½“è¯†åˆ«ä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªç¯èŠ‚ï¼Œç›¸å…³æ¦‚å¿µä»¥ååœ¨æ…¢æ…¢æ•´ç†</p>
</blockquote>
<h3 id="åˆ©ç”¨è¿ç§»å­¦ä¹ ä¼˜åŒ–ä¸€ä¸ªç‰©ä½“è¯†åˆ«ç½‘ç»œæ¨¡å‹"><a href="#åˆ©ç”¨è¿ç§»å­¦ä¹ ä¼˜åŒ–ä¸€ä¸ªç‰©ä½“è¯†åˆ«ç½‘ç»œæ¨¡å‹" class="headerlink" title="åˆ©ç”¨è¿ç§»å­¦ä¹ ä¼˜åŒ–ä¸€ä¸ªç‰©ä½“è¯†åˆ«ç½‘ç»œæ¨¡å‹"></a>åˆ©ç”¨è¿ç§»å­¦ä¹ ä¼˜åŒ–ä¸€ä¸ªç‰©ä½“è¯†åˆ«ç½‘ç»œæ¨¡å‹</h3><p>ä¸Šè¿°æ–¹æ³•è™½ç„¶ç®€å•å®¹æ˜“ç†è§£ï¼Œä½†å­˜åœ¨å¾ˆå¤§çš„è®¡ç®—æ•ˆç‡é—®é¢˜ï¼Œæ¯å¼ å›¾ç‰‡éœ€è¦è¿›è¡Œå¤šæ¬¡ç‰¹å¾æå–å’Œå¤šæ¬¡è¿ç®—ï¼Œå¯¹è®¡ç®—æ•ˆç‡é€ æˆå¾ˆå¤§å½±å“ã€‚ç›®å‰ä¸»æµçš„ç‰©ä½“è¯†åˆ«ç®—æ³•å¾€å¾€éƒ½å¯ä»¥åº”ç”¨äºå®æ—¶è§†é¢‘æµçš„åˆ†æï¼Œæ˜¾ç„¶ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ˜¯ä¸åˆé€‚çš„ã€‚æˆ‘ä»¬å°†åœ¨åé¢æ¢è®¨åˆ©ç”¨ç°æœ‰çš„ç‰©ä½“è¯†åˆ«ç½‘ç»œé€šè¿‡è¿ç§»å­¦ä¹ è§£å†³æˆ‘ä»¬çš„ç›®æ ‡è¯†åˆ«é—®é¢˜ã€‚</p>
<p>ç”±äºæœ¬ç¯‡å†…å®¹å¤ªå¤šï¼Œåˆ©ç”¨è¿ç§»å­¦ä¹ å®ç°çš„æ–¹æ³•ï¼Œå°†å•ç‹¬ä½œä¸ºä¸€ç¯‡ï¼Œæ­¤å¤„ç•™å¾…æ’å…¥<strong>é“¾æ¥</strong>ã€‚</p>
<p>æœ¬æ–‡æ¶‰åŠä»£ç è¯¦è§<a href="https://github.com/ddebby/AI-Lab">Github</a></p>
<h2 id="è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»ç½‘ç»œæ£€æŸ¥è´§æ¶ä¸Šæ˜¯å¦æœ‰ç™¾äº‹å¯ä¹"><a href="#è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»ç½‘ç»œæ£€æŸ¥è´§æ¶ä¸Šæ˜¯å¦æœ‰ç™¾äº‹å¯ä¹" class="headerlink" title="è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»ç½‘ç»œæ£€æŸ¥è´§æ¶ä¸Šæ˜¯å¦æœ‰ç™¾äº‹å¯ä¹"></a>è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»ç½‘ç»œæ£€æŸ¥è´§æ¶ä¸Šæ˜¯å¦æœ‰ç™¾äº‹å¯ä¹</h2><blockquote>
<p>å‚è€ƒ<a href="https://github.com/Anubhav-Bhargava/Logo-Classifier/blob/master/logo_clf_sliding_window.ipynb">Githubå®ç°</a>ä¸€ä¸ªç‰©å“æ£€æµ‹åŸå‹ï¼šè®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»åˆ†ç±»å™¨</p>
</blockquote>
<ol>
<li>åœ¨æ•°æ®å‡†å¤‡é˜¶æ®µä¸ä¸Šè¿°è¿‡ç¨‹å”¯ä¸€ä¸åŒæ˜¯labelçš„è®¾ç½®ï¼Œå¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data = []</span><br><span class="line">labels = []</span><br><span class="line">HEIGHT = <span class="number">64</span></span><br><span class="line">WIDTH = <span class="number">64</span></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> os.listdir(<span class="string">"./flickr_logos_27_dataset/cropped/"</span>):</span><br><span class="line">    img_file = cv2.imread(os.path.join(<span class="string">"./flickr_logos_27_dataset/cropped/"</span>,img))</span><br><span class="line">    data.append(img_file)</span><br><span class="line">    label = img.split(<span class="string">"_"</span>)[<span class="number">1</span>].split(<span class="string">"."</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> label != <span class="string">"Pepsi"</span>:</span><br><span class="line">        label = <span class="string">"Nop"</span></span><br><span class="line">    labels.append(label)</span><br><span class="line">data = np.stack(data)</span><br><span class="line">labels = np.stack(labels)</span><br></pre></td></tr></table></figure>
<ol>
<li><p>ç”±äºæ˜¯äºŒåˆ†ç±»é—®é¢˜ï¼Œæ‰€ä»¥åªéœ€è¦æœ€åä¸€å±‚ä½¿ç”¨sigmoidå‡½æ•°æ„å»ºåˆ†ç±»å™¨å³å¯ï¼Œlabelçš„åºåˆ—è¯æ–¹é¢ä½¿ç”¨LabelEncoderè½¬æ¢ä¸º0æˆ–è€…1å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">lb = LabelEncoder()</span><br><span class="line">y = lb.fit_transform(labels)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ•°æ®å¢å¼ºä¸å‰æ–‡ç±»ä¼¼ï¼Œä¸å†èµ˜è¨€ã€‚åœ¨ç½‘ç»œç»“æ„ä¸Šï¼Œåªéœ€è¦ä¿®æ”¹æœ€åä¸ºsigmoidå‡½æ•°è¾“å‡ºï¼Œä¼˜åŒ–ç›®æ ‡ä½¿ç”¨<code>binary_crossentropy</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">model.add(Activation(<span class="string">"sigmoid"</span>))</span><br><span class="line">...</span><br><span class="line">model.compile(loss=<span class="string">"binary_crossentropy"</span>, optimizer=opt,</span><br><span class="line">	metrics=[<span class="string">"accuracy"</span>])</span><br></pre></td></tr></table></figure>
<p>ç”±äºåªæœ‰ä¸¤ä¸ªåˆ†ç±»ï¼Œæ‰€ä»¥æ¨¡å‹å¾ˆå®¹æ˜“æ”¶æ•›ï¼Œæœ€åå‡†ç¡®ç‡ä¹Ÿæ¥è¿‘100%ã€‚</p>
</li>
<li><p>æœ€ååˆ©ç”¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸åœçš„æ‰«æå›¾åƒå¹¶åˆ©ç”¨cv2å±•ç¤ºç»“æœå³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (x, y, window) <span class="keyword">in</span> sliding_window(img, stepSize=<span class="number">32</span>, windowSize=(winW, winH)):</span><br><span class="line">    <span class="comment"># if the window does not meet our desired window size, ignore it</span></span><br><span class="line">    <span class="keyword">if</span> window.shape[<span class="number">0</span>] != winH <span class="keyword">or</span> window.shape[<span class="number">1</span>] != winW:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">   </span><br><span class="line">    crop_img=crop_image(sample_path,x, y, x + winW, y + winH)</span><br><span class="line">    crop_img=imresize(crop_img,(<span class="number">64</span>,<span class="number">64</span>))</span><br><span class="line">    crop_img = crop_img/<span class="number">255</span></span><br><span class="line">    prediction=model.predict(crop_img.reshape(<span class="number">1</span>,<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>))</span><br><span class="line">    <span class="keyword">if</span> prediction == <span class="number">1</span>:</span><br><span class="line">        pred = <span class="string">'Pepsi'</span>    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    	pred=<span class="string">' '</span></span><br><span class="line">   	</span><br><span class="line">    clone = img.copy()</span><br><span class="line">    cv2.putText(clone, pred, (<span class="number">10</span>, <span class="number">30</span>),cv2.FONT_HERSHEY_SIMPLEX, <span class="number">0.7</span>, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">2</span>)</span><br><span class="line">    cv2.rectangle(clone, (x, y), (x + winW, y + winH), (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">2</span>)</span><br><span class="line">    clone = cv2.cvtColor(clone,cv2.COLOR_BGR2RGB)</span><br><span class="line">    cv2.imshow(<span class="string">"Window"</span>, clone)</span><br><span class="line">    </span><br><span class="line">    cv2.waitKey(<span class="number">1</span>)</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<p>â€‹</p>
</li>
</ol>
<h2 id="Logoæ£€æµ‹çš„åº”ç”¨åŠåˆ†æ"><a href="#Logoæ£€æµ‹çš„åº”ç”¨åŠåˆ†æ" class="headerlink" title="Logoæ£€æµ‹çš„åº”ç”¨åŠåˆ†æ"></a>Logoæ£€æµ‹çš„åº”ç”¨åŠåˆ†æ</h2><p><a href="https://blog.deepsense.ai/logo-detection-and-brand-visibility-analytics/">DeepSense.ai</a>ç»™å‡ºäº†ä¸€ç§Logoæ£€æµ‹çš„åˆ†ææ–¹æ³•ï¼Œé€šè¿‡åˆ†æè§†é¢‘ä¸­ä¸åŒå“ç‰Œçš„logoå‘ˆç°ï¼Œç»Ÿè®¡äº†ä¸åŒå“ç‰Œåœ¨åŒä¸€ä¸ªè§†é¢‘ä¸­Logoå‡ºç°çš„æ—¶é—´ã€å‡ºç°çš„æ–¹å¼ã€å‘ˆç°çš„æ•ˆæœç­‰ï¼Œæœ€ç»ˆæä¾›ç»™å®¢æˆ·ä¸€ä¸ª<strong>Logo Visubility Report</strong>ã€‚</p>
<p>æ–¹æ¡ˆçš„ä¸»è¦æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/logo_detection_overview.jpg" alt="logo_detection_overview"></p>
<p>ç”Ÿæˆçš„åˆ†ææŠ¥å‘Šå‚è§ä¸‹å›¾ï¼š</p>
<p><img src="/qnsource/images/2018-04-09-Deep-Learning-Lab-Logo-Detection/logo_detection_report.png" alt="logo_detection_report"></p>
<p>é’ˆå¯¹çš„åˆ†æè§†é¢‘å¦‚ä¸‹ï¼š</p>
<div class="video-container"><iframe src="//www.youtube.com/embed/ekaHlWga5yA" frameborder="0" allowfullscreen></iframe></div>
<hr>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a href="http://image.ntua.gr/iva/datasets/flickr_logos/">Flickr Logos 27 dataset</a></li>
<li><a href="http://www.multimedia-computing.de/flickrlogos/#flickrlogos47">Datasets: FlickrLogos-32 / FlickrLogos-47</a></li>
<li>â€‹</li>
</ol>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-03-05T08:52:33.000Z">2018-03-05</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1462 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/03/05/è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/">è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical Python and OpenCVã€‹</a>
            
        </h1>
        <div class="content">
            <p>ã€ŠPractical Python and OpenCVã€‹è¯»ä¹¦æœ­è®°ã€‚</p>
<!-- excerpt -->
<h2 id="1-Loadï¼ŒDisplay-and-Save-an-Image"><a href="#1-Loadï¼ŒDisplay-and-Save-an-Image" class="headerlink" title="1. Loadï¼ŒDisplay and Save an Image"></a>1. Loadï¼ŒDisplay and Save an Image</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="comment"># Load the image and show some basic information on it</span></span><br><span class="line">image = cv2.imread(<span class="string">"Path/to/Image"</span>)</span><br><span class="line"><span class="comment"># Show the image and wait for a keypress</span></span><br><span class="line">cv2.imshow(<span class="string">"Image"</span>, image)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># Save the image -- OpenCV handles converting filetypes</span></span><br><span class="line"><span class="comment"># automatically</span></span><br><span class="line">cv2.imwrite(<span class="string">"newimage.jpg"</span>, image)</span><br></pre></td></tr></table></figure>
<h2 id="2-cv2"><a href="#2-cv2" class="headerlink" title="2. cv2"></a>2. cv2</h2><p><strong>å›¾åƒä¸Šæ·»åŠ çº¿æ¡åŠå½¢çŠ¶</strong></p>
<ul>
<li><code>cv2.line(image, start_point, stop_point, color, thickness)</code></li>
<li><code>cv2.rectangle(image,top_left, bottom_right, color, thickness)</code><ul>
<li><code>thickness</code> ä¸ºè´Ÿæ•°ï¼Œå¡«å……å½¢çŠ¶</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize our canvas as a 300x300 with 3 channels,</span></span><br><span class="line"><span class="comment"># Red, Green, and Blue, with a black background</span></span><br><span class="line">canvas = np.zeros((<span class="number">300</span>, <span class="number">300</span>, <span class="number">3</span>), dtype = <span class="string">"uint8"</span>)</span><br><span class="line"><span class="comment"># Draw a green line from the top-left corner of our canvas</span></span><br><span class="line"><span class="comment"># to the bottom-right</span></span><br><span class="line">green = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">cv2.line(canvas, (<span class="number">0</span>, <span class="number">0</span>), (<span class="number">300</span>, <span class="number">300</span>), green)</span><br><span class="line"><span class="comment"># Now, draw a 3 pixel thick red line from the top-right</span></span><br><span class="line"><span class="comment"># corner to the bottom-left</span></span><br><span class="line">red = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">cv2.line(canvas, (<span class="number">300</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">300</span>), red, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># Draw a green 50x50 pixel square, starting at 10x10 and</span></span><br><span class="line"><span class="comment"># ending at 60x60</span></span><br><span class="line">cv2.rectangle(canvas, (<span class="number">10</span>, <span class="number">10</span>), (<span class="number">60</span>, <span class="number">60</span>), green)</span><br><span class="line"><span class="comment"># Draw another rectangle, this time we'll make it red and</span></span><br><span class="line"><span class="comment"># 5 pixels thick</span></span><br><span class="line">cv2.rectangle(canvas, (<span class="number">50</span>, <span class="number">200</span>), (<span class="number">200</span>, <span class="number">225</span>), red, <span class="number">5</span>)</span><br><span class="line"><span class="comment"># Let's draw one last rectangle: blue and filled in</span></span><br><span class="line">blue = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">cv2.rectangle(canvas, (<span class="number">200</span>, <span class="number">50</span>), (<span class="number">225</span>, <span class="number">125</span>), blue, <span class="number">-1</span>)</span><br><span class="line">cv2.imshow(<span class="string">"Canvas"</span>, canvas)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-03-05-è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/Line and Rectangle.png" alt="Line and Rectangle"></p>
<p><strong>æ·»åŠ åœ†å½¢</strong></p>
<ul>
<li><code>cv2.circle(image, (centerX, centerY), r, color,thickness)</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reset our canvas and draw a white circle at the center</span></span><br><span class="line"><span class="comment"># of the canvas with increasing radii - from 25 pixels to</span></span><br><span class="line"><span class="comment"># 150 pixels</span></span><br><span class="line">canvas = np.zeros((<span class="number">300</span>, <span class="number">300</span>, <span class="number">3</span>), dtype = <span class="string">"uint8"</span>)</span><br><span class="line">(centerX, centerY) = (canvas.shape[<span class="number">1</span>] // <span class="number">2</span>, canvas.shape[<span class="number">0</span>] // <span class="number">2</span>)</span><br><span class="line">white = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">175</span>, <span class="number">25</span>):</span><br><span class="line">	cv2.circle(canvas, (centerX, centerY), r, white)</span><br><span class="line">cv2.imshow(<span class="string">"Canvas"</span>, canvas)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-03-05-è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/Circles.png" alt="Circles"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Let's go crazy and draw 25 random circles</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">25</span>):</span><br><span class="line">	<span class="comment"># randomly generate a radius size between 5 and 200,</span></span><br><span class="line">	<span class="comment"># generate a random color, and then pick a random</span></span><br><span class="line">	<span class="comment"># point on our canvas where the circle will be drawn</span></span><br><span class="line">	radius = np.random.randint(<span class="number">5</span>, high = <span class="number">200</span>)</span><br><span class="line">	color = np.random.randint(<span class="number">0</span>, high = <span class="number">256</span>, size = (<span class="number">3</span>,)).tolist()</span><br><span class="line">	pt = np.random.randint(<span class="number">0</span>, high = <span class="number">300</span>, size = (<span class="number">2</span>,))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># draw our random circle</span></span><br><span class="line">	cv2.circle(canvas, tuple(pt), radius, color, <span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show our masterpiece</span></span><br><span class="line">cv2.imshow(<span class="string">"Canvas"</span>, canvas)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-03-05-è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/RandomCircles.png" alt="RandomCircles"></p>
<h2 id="3-Image-Processing"><a href="#3-Image-Processing" class="headerlink" title="3. Image Processing"></a>3. Image Processing</h2><ol>
<li><p>å¹³ç§»</p>
<ul>
<li><code>cv2.warpAffine()</code></li>
<li>imutil</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translate</span><span class="params">(image, x, y)</span>:</span></span><br><span class="line">	<span class="comment"># Define the translation matrix and perform the translation</span></span><br><span class="line">	M = np.float32([[<span class="number">1</span>, <span class="number">0</span>, x], [<span class="number">0</span>, <span class="number">1</span>, y]])</span><br><span class="line">	shifted = cv2.warpAffine(image, M, (image.shape[<span class="number">1</span>], image.shape[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Return the translated image</span></span><br><span class="line">	<span class="keyword">return</span> shifted</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ—‹è½¬</p>
<ul>
<li><code>cv2.getRotationMatrix2D</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotate</span><span class="params">(image, angle, center = None, scale = <span class="number">1.0</span>)</span>:</span></span><br><span class="line">	<span class="comment"># Grab the dimensions of the image</span></span><br><span class="line">	(h, w) = image.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># If the center is None, initialize it as the center of</span></span><br><span class="line">	<span class="comment"># the image</span></span><br><span class="line">	<span class="keyword">if</span> center <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">		center = (w / <span class="number">2</span>, h / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Perform the rotation</span></span><br><span class="line">	M = cv2.getRotationMatrix2D(center, angle, scale)</span><br><span class="line">	rotated = cv2.warpAffine(image, M, (w, h))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Return the rotated image</span></span><br><span class="line">	<span class="keyword">return</span> rotated</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼©æ”¾</p>
<ul>
<li><code>cv2.resize</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">resize</span><span class="params">(image, width = None, height = None, inter = cv2.INTER_AREA)</span>:</span></span><br><span class="line">	<span class="comment"># initialize the dimensions of the image to be resized and grab the image size</span></span><br><span class="line">	dim = <span class="keyword">None</span></span><br><span class="line">	(h, w) = image.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># if both the width and height are None, then return the original image</span></span><br><span class="line">	<span class="keyword">if</span> width <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">and</span> height <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">		<span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line">	<span class="comment"># check to see if the width is None</span></span><br><span class="line">	<span class="keyword">if</span> width <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">		<span class="comment"># calculate the ratio of the height and construct the dimensions</span></span><br><span class="line">		r = height / float(h)</span><br><span class="line">		dim = (int(w * r), height)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># otherwise, the height is None</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="comment"># calculate the ratio of the width and construct the dimensions</span></span><br><span class="line">		r = width / float(w)</span><br><span class="line">		dim = (width, int(h * r))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># resize the image</span></span><br><span class="line">	resized = cv2.resize(image, dim, interpolation = inter)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># return the resized image</span></span><br><span class="line">	<span class="keyword">return</span> resized</span><br></pre></td></tr></table></figure>
</li>
<li><p>åè½¬</p>
<ul>
<li><code>cv2.flip(image, num)</code></li>
<li>num=1, æ°´å¹³åè½¬ï¼›num=0ï¼Œå‚ç›´ç¿»è½¬ï¼›numä¸ºè´Ÿï¼Œå¯¹è§’åè½¬</li>
</ul>
</li>
<li><p>bitwise</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bitwiseAnd = cv2.bitwise_and(rectangle, circle) cv2.imshow(<span class="string">"AND"</span>, bitwiseAnd) </span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>MASKING</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mask = np.zeros(image.shape[:<span class="number">2</span>], dtype = <span class="string">"uint8"</span>) </span><br><span class="line">cv2.circle(mask, (cX, cY), <span class="number">100</span>, <span class="number">255</span>, <span class="number">-1</span>) </span><br><span class="line">masked = cv2.bitwise_and(image, image, mask = mask)  cv2.imshow(<span class="string">"Mask"</span>, mask) </span><br><span class="line">cv2.imshow(<span class="string">"Mask Applied to Image"</span>, masked) </span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‰²å½©ç©ºé—´å˜æ¢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Load the image and show it</span></span><br><span class="line">image = cv2.imread(args[<span class="string">"image"</span>])</span><br><span class="line"><span class="comment"># Convert the image to grayscale</span></span><br><span class="line">gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line"><span class="comment"># Convert the image to the HSV (Hue, Saturation, Value)</span></span><br><span class="line"><span class="comment"># color spaces</span></span><br><span class="line">hsv = cv2.cvtColor(image, cv2.COLOR_BGR2HSV)</span><br><span class="line"><span class="comment"># Convert the image to the L*a*b* color spaces</span></span><br><span class="line">lab = cv2.cvtColor(image, cv2.COLOR_BGR2LAB)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¹³æ»‘/æ¨¡ç³Šï¼ˆblurringï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Averaging Blurring</span></span><br><span class="line">cv2.blur(image, (<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"><span class="comment"># Gaussian Blurring</span></span><br><span class="line">cv2.GaussianBlur(image, (<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>)</span><br><span class="line"><span class="comment"># Median Blurring</span></span><br><span class="line">cv2.medianBlur(image, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># Bilateral Blurring</span></span><br><span class="line">cv2.bilateralFilter(image, <span class="number">5</span>, <span class="number">21</span>, <span class="number">21</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>Traditionally, the median blur method has been most effective when removing salt-and-pepper noise. </p>
</blockquote>
<ol>
<li><p>Threshold</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(T, thresh) = cv2.threshold(blurred, <span class="number">155</span>, <span class="number">255</span>, cv2.THRESH_BINARY) </span><br><span class="line">cv2.imshow(<span class="string">"Threshold Binary"</span>, thresh) </span><br><span class="line">(T, threshInv) = cv2.threshold(blurred, <span class="number">155</span>, <span class="number">255</span>, cv2. THRESH_BINARY_INV)</span><br><span class="line">cv2.bitwise_and(image, image, mask = threshInv)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¾¹ç¼˜æ£€æµ‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">image = cv2.imread(img)</span><br><span class="line">image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line">image = cv2.GaussianBlur(image, (<span class="number">5</span>,<span class="number">5</span>), <span class="number">0</span>)</span><br><span class="line">canny = cv2.Canny(image, <span class="number">30</span> ,<span class="number">150</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/qnsource/images/2018-03-05-è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/canny.jpg" alt="canny"></p>
<ol>
<li><p>è½®å»“æ£€æµ‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">image = cv2.imread(img)</span><br><span class="line">image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line">image = cv2.GaussianBlur(image, (<span class="number">11</span>,<span class="number">11</span>), <span class="number">0</span>)</span><br><span class="line">canny = cv2.Canny(image, <span class="number">30</span> ,<span class="number">150</span>)</span><br><span class="line">(_, cnts, _) = cv2.findContours(canny.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span><br><span class="line">print(<span class="string">"I count &#123;&#125; coins in this image"</span>.format(len(cnts)))</span><br><span class="line">coins = image.copy()</span><br><span class="line">cv2.drawContours(coins, cnts, <span class="number">-1</span>, (<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>), <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/qnsource/images/2018-03-05-è¯»ä¹¦ç¬”è®°ï¼šã€ŠPractical-Python-and-OpenCVã€‹/countours.jpg" alt="countours"></p>
<ul>
<li>ä»å›¾åƒä¸­å°†å¯¹è±¡æ‰£å–</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Now, let's loop over each contour</span></span><br><span class="line"><span class="keyword">for</span> (i, c) <span class="keyword">in</span> enumerate(cnts):</span><br><span class="line">	<span class="comment"># We can compute the 'bounding box' for each contour, which is the rectangle that encloses the contour</span></span><br><span class="line">	(x, y, w, h) = cv2.boundingRect(c)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Now that we have the contour, let's extract it using array slices</span></span><br><span class="line">	print(<span class="string">"Coin #&#123;&#125;"</span>.format(i + <span class="number">1</span>))</span><br><span class="line">	coin = image[y:y + h, x:x + w]</span><br><span class="line">	cv2.imshow(<span class="string">"Coin"</span>, coin)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Just for fun, let's construct a mask for the coin by finding The minumum enclosing circle of the contour</span></span><br><span class="line">	mask = np.zeros(image.shape[:<span class="number">2</span>], dtype = <span class="string">"uint8"</span>)</span><br><span class="line">	((centerX, centerY), radius) = cv2.minEnclosingCircle(c)</span><br><span class="line">	cv2.circle(mask, (int(centerX), int(centerY)), int(radius), <span class="number">255</span>, <span class="number">-1</span>)</span><br><span class="line">	mask = mask[y:y + h, x:x + w]</span><br><span class="line">	cv2.imshow(<span class="string">"Masked Coin"</span>, cv2.bitwise_and(coin, coin, mask = mask))</span><br><span class="line">	cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>â€‹</p>
</li>
</ol>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><ol>
<li><p>ä¸ºè§£å†³python 2.7å’Œpython 3ä¸­<code>print</code>å‡½æ•°ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¯é€šè¿‡å¯¼å…¥å¦‚ä¸‹å‘½ä»¤è§£å†³åœ¨python 2.7ç¯å¢ƒè¿è¡Œpython 3ä¸­<code>print</code>å‡½æ•°ä¸å…¼å®¹çš„é—®é¢˜ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br></pre></td></tr></table></figure>
</li>
<li><p>OpenCVå­˜å‚¨RGBä¿¡æ¯é‡‡ç”¨çš„é€†å‘å­˜å‚¨æ–¹å¼ï¼Œå³ä¸ºBGR; <code>matplotlib.plot</code>ä¸­ä¸º<code>RGB</code></p>
</li>
<li><p><code>np.random</code></p>
</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>Method</th>
<th>Desription</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.rand.html#numpy.random.rand"><code>rand</code></a>(d0, d1, â€¦, dn)</td>
<td>Random values in a given shape.</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.randn.html#numpy.random.randn"><code>randn</code></a>(d0, d1, â€¦, dn)</td>
<td>Return a sample (or samples) from the â€œstandard normalâ€ distribution.</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.randint.html#numpy.random.randint"><code>randint</code></a>(low[, high, size, dtype])</td>
<td>Return random integers from <em>low</em> (inclusive) to <em>high</em> (exclusive).</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.random_integers.html#numpy.random.random_integers"><code>random_integers</code></a>(low[, high, size])</td>
<td>Random integers of type np.int between <em>low</em> and <em>high</em>, inclusive.</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.random_sample.html#numpy.random.random_sample"><code>random_sample</code></a>([size])</td>
<td>Return random floats in the half-open interval [0.0, 1.0).</td>
</tr>
<tr>
<td><strong>random([size])</strong></td>
<td>Return random floats in the half-open interval [0.0, 1.0).äº§ç”ŸéšæœºçŸ©é˜µï¼Œå¦‚random.random([2,3])äº§ç”Ÿä¸€ä¸ª2x3ç»´çš„éšæœºæ•°</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.ranf.html#numpy.random.ranf">ranf</a>([size])</td>
<td>Return random floats in the half-open interval [0.0, 1.0).</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.sample.html#numpy.random.sample"><code>sample</code></a>([size])</td>
<td>Return random floats in the half-open interval [0.0, 1.0).</td>
</tr>
<tr>
<td><strong>choice(a[, size, replace, p])</strong></td>
<td>Generates a random sample from a given 1-D array</td>
</tr>
<tr>
<td><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.bytes.html#numpy.random.bytes"><code>bytes</code></a>(length)</td>
<td>Return random bytes.</td>
</tr>
</tbody>
</table>
</div>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                

                <time class="level-item has-text-grey" datetime="2018-03-03T14:12:49.000Z">2018-03-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/">è¯»ä¹¦ç¬”è®°</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/è¯»ä¹¦ç¬”è®°/æœºå™¨è§†è§‰/">æœºå™¨è§†è§‰</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    23 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3439 ä¸ªå­—)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/03/03/Deep-Learning-for-Computer-Vision/">Deep Learning for Computer Vision</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>æœ¬æ–‡è®°å½•æ·±åº¦å­¦ä¹ ä¹¦ç±ã€ŠDeep Learning for Computer Vision with Pythonã€‹çš„è¯»ä¹¦ç¬”è®°ã€‚</p>
</blockquote>
<!-- excerpt -->
<p>@toc</p>
<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul>
<li>æ·±åº¦å­¦ä¹ æ‹¥æœ‰60å¤šå¹´å†å²ï¼Œè™½ç„¶æ›¾ç»é‡‡ç”¨è¿‡ä¸åŒçš„åç§°å’Œä¸åŒçš„ä¸»å¯¼æŠ€æœ¯ï¼šâ€œdeep learningâ€ has existed since the 1940s undergoing various name changes, including cybernetics, connectionism, and the most familiar, Artificial Neural Networks (ANNs).</li>
<li>ç¥ç»ç½‘ç»œçš„æ™®é€‚å®šå¾‹ï¼šFurther research demonstrated that neural networks are universal approximators , capable of approximating any continuous function (but placing <strong>no guarantee</strong> on whether or not the network can actually learn the parameters required to represent a function).</li>
<li>Classic machine learning algorithms for <strong>unsupervised learning</strong> include Principle Component Analysis (PCA) and k-means clustering. Specific to neural networks, we see Autoencoders, Self-Organizing Maps (SOMs), and Adaptive Resonance Theory applied to unsupervised learning. </li>
<li>Popular choices for <strong>semisupervised learning</strong> include label spreading, label propagation, ladder networks, and co-learning/co-training.</li>
</ul>
<h2 id="Image-and-Pixels"><a href="#Image-and-Pixels" class="headerlink" title="Image and Pixels"></a>Image and Pixels</h2><ul>
<li>Pixels are represented in two ways:<ul>
<li>Grayscale: Each pixel is a scalar value between 0 and 255.ï¼ˆ0 for â€œBlackâ€ and 255 for â€œWhiteâ€ï¼‰ï¼Œ0â€”&gt;255 dark â€”&gt; light</li>
<li>Color: RGB color space, (R,G,B), Each Red, Green, and Blue channel can have values defined in the range [0,255] for a total of 256 â€œshadesâ€, where 0 indicates no representation and 255 demonstrates full representation.</li>
</ul>
</li>
<li>Given that the pixel value only needs to be in the range [0,255], we normally use 8-bit unsigned integers to represent the intensity.</li>
</ul>
<h3 id="Images-as-Numpy-Arrays"><a href="#Images-as-Numpy-Arrays" class="headerlink" title="Images as Numpy Arrays"></a>Images as Numpy Arrays</h3><ul>
<li>(height, width, depth) è¡¨ç¤º</li>
</ul>
<blockquote>
<p>height æ’ç¬¬ä¸€çš„ä¸»è¦åŸå› æ˜¯ç”±äºçŸ©é˜µè¡¨ç¤ºå½¢å¼ä¸­ï¼Œä¸€èˆ¬æŠŠè¡Œæ”¾åœ¨å‰é¢ï¼Œè€Œå›¾åƒä¸­heightå¤§å°è¡¨å¾äº†è¡Œçš„æ•°ç›®ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">image = cv2.imread(<span class="string">"example.png"</span>) print(image.shape)</span><br><span class="line">cv2.imshow(<span class="string">"Image"</span>, image)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"><span class="comment">## Access an individual pixel value</span></span><br><span class="line">(b, g, r) = image[<span class="number">20</span>, <span class="number">100</span>] <span class="comment"># accesses pixel at x=100, y=20</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>å–åƒç´ yåœ¨xå‰é¢ï¼Œè¿˜æ˜¯ç”±äºçŸ©é˜µçš„è¡¨ç¤ºå½¢å¼ï¼›</li>
<li>RGBé¡ºåºåçš„ï¼Œè¿™æ˜¯ç”±äºOpenCVå†å²åŸå› å¯¼è‡´çš„è¡¨ç¤ºå½¢å¼å·®å¼‚: Because the BGR ordering was popular among camera manufacturers and other software developers at the time.</li>
</ol>
</blockquote>
<h3 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h3><p><strong>aspect ratio</strong>: the ratio of the width to the height of the image.</p>
<p>ç¥ç»ç½‘ç»œæ¨¡å‹ä¸€èˆ¬éƒ½æ˜¯å›ºå®šè¾“å…¥ï¼Œæ¯”å¦‚32Ã—32, 64Ã—64, 224Ã—224, 227Ã—227, 256Ã—256, and 299Ã—299. éœ€è¦å¯¹ä¸åŒå¤§å°çš„å›¾åƒè¿›è¡Œreshapeæ“ä½œï¼ŒFor some datasets you can simply ignore the aspect ratio and squish, distort, and compress your images prior to feeding them through your network. On other datasets, itâ€™s advantageous to preprocess them further by resizing along the shortest dimension and then cropping the center.</p>
<h2 id="Image-Classification"><a href="#Image-Classification" class="headerlink" title="Image Classification"></a>Image Classification</h2><p>å›¾åƒåˆ†ç±»å’Œå›¾åƒç†è§£æ˜¯å½“ä»ŠæŠ€æœ¯è§†è§‰é¢†åŸŸæœ€ç«çš„è¯¾é¢˜ã€‚</p>
<h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p><strong>å›¾åƒåˆ†ç±»ï¼š</strong> the task of assigning a label to an image from a predefined set ofcategories.</p>
<blockquote>
<p>å›¾åƒåˆ†ç±»çš„è¿‡ç¨‹æ˜¯å­¦ä¹ å›¾ç‰‡ä¸­çš„â€œunderlying patternsâ€</p>
</blockquote>
<p><strong>Semantic Gapï¼š</strong> the difference between how a human perceives the contents of an image versus how an image can be represented in a way a computer can understand the process.</p>
<h3 id="æŒ‘æˆ˜"><a href="#æŒ‘æˆ˜" class="headerlink" title="æŒ‘æˆ˜"></a>æŒ‘æˆ˜</h3><p><img src="/qnsource/images/2018-03-03-Deep-Learning-for-Computer-Vision/Challenge for Image Classification.png" alt="Challenge for Image Classification"></p>
<h3 id="æ•°æ®é›†-TODO"><a href="#æ•°æ®é›†-TODO" class="headerlink" title="æ•°æ®é›†(TODO)"></a>æ•°æ®é›†(TODO)</h3><ol>
<li><p>MNIST</p>
<ul>
<li><p><strong>ç›®æ ‡ï¼š</strong> å®Œæˆ0-9æ‰‹å†™å­—ç¬¦çš„è¯†åˆ«</p>
</li>
<li><p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>NIST</code>ä»£è¡¨<code>National Institute ofStandards and Technology</code>ï¼Œ <code>M</code>ä»£è¡¨<code>Modified</code></li>
<li>æ·±åº¦å­¦ä¹ çš„<code>Hello World</code></li>
<li>åŒ…å«60,000è®­ç»ƒæ ·æœ¬ï¼Œ10,000æµ‹è¯•æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬ä¸º28x28çš„ç°åº¦å›¾åƒ</li>
</ul>
</li>
<li><p><strong>ç›®å‰å‡†ç¡®åº¦ï¼š</strong> &gt;99%</p>
</li>
<li><p><strong>è·å–åœ°å€ï¼š</strong> <a href="http://yann.lecun.com/exdb/mnist/">http://yann.lecun.com/exdb/mnist/</a></p>
<p><img src="/qnsource/images/2018-03-03-Deep-Learning-for-Computer-Vision/MNIST.jpg" alt="MNIST"></p>
</li>
</ul>
</li>
<li><p>Fashion-MNIST</p>
<ul>
<li><p><strong>ç›®æ ‡ï¼š</strong> å®Œæˆ10ç§ä¸åŒè¡£æœçš„è¯†åˆ«</p>
</li>
<li><p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li>æ ¹æ®MNISTè®¾è®¡çš„æ–°çš„æ•°æ®é›†ï¼Œéš¾åº¦æ¯”MNISTç•¥é«˜</li>
<li>åŒ…å«60,000è®­ç»ƒæ ·æœ¬ï¼Œ10,000æµ‹è¯•æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬ä¸º28x28çš„ç°åº¦å›¾åƒ</li>
</ul>
</li>
<li><p><strong>ç›®å‰å‡†ç¡®åº¦ï¼š</strong> &gt;95%</p>
</li>
<li><p><strong>è·å–åœ°å€ï¼š</strong> <a href="https://github.com/zalandoresearch/fashion-mnist">https://github.com/zalandoresearch/fashion-mnist</a></p>
<p><img src="/qnsource/images/2018-03-03-Deep-Learning-for-Computer-Vision/Fashion-MNIST.png" alt="Fashion-MNIST"></p>
</li>
</ul>
</li>
<li><p>CIFAR-10</p>
</li>
<li><p>Animalsï¼š Dogsï¼ŒCatï¼Œ Pandas</p>
</li>
<li><p>Flowers-17</p>
</li>
<li><p>CALtECH-101</p>
</li>
<li><p>Tiny ImageNet 200</p>
</li>
<li><p>Adience</p>
</li>
<li><p>ImageNet</p>
</li>
<li><p>è¡¨æƒ…è¯†åˆ«(æ˜¯å¦ç¬‘è„¸)</p>
<ul>
<li><strong>è¯´æ˜ï¼š</strong></li>
<li>å…±è®¡13165å¼ ç°åº¦å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡å¤§å°ä¸º64x64</li>
<li>åˆ†ä¸ºç¬‘è„¸å’Œéç¬‘è„¸ä¸¤ç±»ï¼Œå…¶ä¸­ç¬‘è„¸3690å¼ ï¼Œéç¬‘è„¸9475å¼ ï¼ˆæ•°æ®ä¸å¹³è¡¡ï¼‰</li>
<li><strong>è·å–åœ°å€ï¼š</strong><a href="https://github.com/hromi/SMILEsmileD">https://github.com/hromi/SMILEsmileD</a></li>
<li>å¦å¤–<a href="https://www.kaggle.com/c/challenges-in-representation-learning-facial-expression-recognition-challenge/data">fer2013</a>æä¾›äº†æ›´å¤šè¡¨æƒ…çš„è®­ç»ƒç”¨æ•°æ®é›†</li>
</ul>
</li>
</ol>
<p><img src="/qnsource/images/2018-03-03-Deep-Learning-for-Computer-Vision/Smile Datasets.png" alt="Smile Datasets"></p>
<ol>
<li>æ€§åˆ«å’Œå¹´é¾„æ•°æ®é›†</li>
</ol>
<ul>
<li><p>IMDB-WIKI â€“ 500k+ face images with age and gender labels</p>
<ul>
<li><p>è·å–åœ°å€ï¼š <a href="https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/">https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/</a></p>
<p><img src="https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/static/img/pipeline.png" alt="img"></p>
</li>
</ul>
</li>
</ul>
<ol>
<li><p>Indoor CVPR</p>
</li>
<li><p>Stanford Cars</p>
</li>
<li><p>â€¦</p>
</li>
</ol>
<h2 id="ç¥ç»ç½‘ç»œåŸºç¡€"><a href="#ç¥ç»ç½‘ç»œåŸºç¡€" class="headerlink" title="ç¥ç»ç½‘ç»œåŸºç¡€"></a>ç¥ç»ç½‘ç»œåŸºç¡€</h2><h3 id="ä¼˜åŒ–ç®—æ³•ï¼ˆTODOï¼Œæ•´åˆåˆ°å•ç‹¬Noteï¼‰"><a href="#ä¼˜åŒ–ç®—æ³•ï¼ˆTODOï¼Œæ•´åˆåˆ°å•ç‹¬Noteï¼‰" class="headerlink" title="ä¼˜åŒ–ç®—æ³•ï¼ˆTODOï¼Œæ•´åˆåˆ°å•ç‹¬Noteï¼‰"></a>ä¼˜åŒ–ç®—æ³•ï¼ˆTODOï¼Œæ•´åˆåˆ°å•ç‹¬Noteï¼‰</h3><ul>
<li>Chapter 8</li>
</ul>
<h3 id="Regularization-TODO-æ•´åˆåˆ°å•ç‹¬Note"><a href="#Regularization-TODO-æ•´åˆåˆ°å•ç‹¬Note" class="headerlink" title="Regularization (TODO, æ•´åˆåˆ°å•ç‹¬Note)"></a>Regularization (TODO, æ•´åˆåˆ°å•ç‹¬Note)</h3><ul>
<li>Chapter 9</li>
<li>chapter 10,æ¿€æ´»å‡½æ•°ï¼Œperception</li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆéªŒè¯æŸå¤±å‡½æ•°å€¼æœ‰æ—¶å€™å°äºè®­ç»ƒæŸå¤±å‡½æ•°"><a href="#ä¸ºä»€ä¹ˆéªŒè¯æŸå¤±å‡½æ•°å€¼æœ‰æ—¶å€™å°äºè®­ç»ƒæŸå¤±å‡½æ•°" class="headerlink" title="ä¸ºä»€ä¹ˆéªŒè¯æŸå¤±å‡½æ•°å€¼æœ‰æ—¶å€™å°äºè®­ç»ƒæŸå¤±å‡½æ•°"></a>ä¸ºä»€ä¹ˆéªŒè¯æŸå¤±å‡½æ•°å€¼æœ‰æ—¶å€™å°äºè®­ç»ƒæŸå¤±å‡½æ•°</h3><p>è¿™å¯èƒ½æ˜¯æœ‰å‡ æ–¹é¢åŸå› å¯¼è‡´çš„ï¼Œæˆ–å¤šæ–¹é¢åŸå› ç»¼åˆä½œç”¨çš„ç»“æœï¼Œä¸»è¦çš„åŸå› åŒ…æ‹¬ï¼š</p>
<ol>
<li>è®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ†å¸ƒä¸å‡ï¼Œå¯¼è‡´è®­ç»ƒé›†æ•°æ®éš¾åº¦å¤§ï¼ŒéªŒè¯é›†ç®€å•æ•°æ®åˆ†å¸ƒæ¯”ä¾‹å¤§ï¼›</li>
<li>æ•°æ®æ”¾å¤§æœ¬èº«å½¢æˆäº†ä¸€ç§è§„åˆ™åŒ–ï¼Œé™ä½äº†è®­ç»ƒé›†çš„è®­ç»ƒç»“æœï¼›ï¼ˆè¿™æœ¬èº«æ˜¯è§„åˆ™åŒ–çš„ç›®æ ‡ï¼Œé™ä½åœ¨è®­ç»ƒé›†çš„è¡¨ç°ï¼Œæå‡æ³›åŒ–æ€§èƒ½ï¼‰</li>
<li>è®­ç»ƒæ—¶é—´æˆ–è½®æ•°ä¸å¤Ÿï¼›</li>
</ol>
<h3 id="å…³äºå­¦ä¹ ç‡"><a href="#å…³äºå­¦ä¹ ç‡" class="headerlink" title="å…³äºå­¦ä¹ ç‡"></a>å…³äºå­¦ä¹ ç‡</h3><ul>
<li><p>kerasä¸­æä¾›äº†<code>decay</code>å‚æ•°æ¥è°ƒèŠ‚å­¦ä¹ ç‡çš„å˜åŒ–æƒ…å†µï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opt = SGD(lr=<span class="number">0.01</span>, decay=<span class="number">0.01</span> / <span class="number">40</span>, momentum=<span class="number">0.9</span>, nesterov=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å…¬å¼ï¼š</p>
<script type="math/tex; mode=display">
\alpha_{e+1} = \alpha_e \times 1 /(1+\gamma * e)</script></li>
<li><p>å¦ä¸€ç§å­¦ä¹ ç‡ä¸ºé˜¶æ¢¯å­¦ä¹ ç‡ï¼š<code>ctrl + c</code></p>
<p>Kerasæä¾›ä¸€ä¸ªç±»ï¼š<code>LearningrateScheduler</code>æ¥é…ç½®è‡ªå®šä¹‰çš„å­¦ä¹ ç‡å‡½æ•°</p>
<p>æ¯”å¦‚ï¼š</p>
<script type="math/tex; mode=display">
\alpha_{E+1} = \alpha_1 \times F^{(1+E)/D}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_decay</span><span class="params">(epoch)</span>:</span></span><br><span class="line">    <span class="comment"># initialize the base initial learning rate, drop factor, and epochs to drop every</span></span><br><span class="line">    initAlpha = <span class="number">0.01</span></span><br><span class="line">    factor = <span class="number">0.25</span></span><br><span class="line">    dropEvery = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># compute learning rate for the current epoch</span></span><br><span class="line">    alpha = initAlpha * (factor ** np.floor((<span class="number">1</span> + epoch) / dropEvery))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># return the learning rate</span></span><br><span class="line">    <span class="keyword">return</span> float(alpha)</span><br><span class="line">  </span><br><span class="line"><span class="comment">##å®šä¹‰callback</span></span><br><span class="line">callbacks = [LearningRateScheduler(step_decay)]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>å½“å®šä¹‰äº†å­¦ä¹ ç‡ä¹‹åï¼ŒSGDä¸­å£°æ˜çš„é…ç½®ä¿¡æ¯å°†è¢«å¿½ç•¥</p>
</blockquote>
<h2 id="ç½‘ç»œæ¨¡å‹"><a href="#ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç½‘ç»œæ¨¡å‹"></a>ç½‘ç»œæ¨¡å‹</h2><h3 id="VGG"><a href="#VGG" class="headerlink" title="VGG"></a>VGG</h3><ul>
<li>æ‰€æœ‰çš„å·ç§¯å±‚ä½¿ç”¨åŒä¸€ç§å·ç§¯æ ¸ï¼š3X3</li>
<li>å †ç§¯å¤šä¸ª<code>CONV=&gt;RELU</code>å±‚å†è¿›è¡Œä¸€æ¬¡<code>POOL</code>æ“ä½œ</li>
</ul>
<h3 id="MNIST"><a href="#MNIST" class="headerlink" title="MNIST"></a>MNIST</h3><p>Researchers tend to use the MNIST dataset as a benchmark to evaluate new classification algorithms. If their methods cannot obtain &gt; 95% classification accuracy, then there is either a flaw in (1) the logic of the algorithm or (2) the implementation itself.</p>
<h2 id="Case-Study"><a href="#Case-Study" class="headerlink" title="Case Study"></a>Case Study</h2><blockquote>
<p>ä½¿ç”¨OpenCVçš„Haar cascade ç®—æ³•è¿›è¡Œäººè„¸æ£€æµ‹ï¼Œæå–äººè„¸çš„ROI(Region of intrest), é€šè¿‡ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œè¡¨æƒ…è¯†åˆ«ï¼›</p>
<p>å¯ä»¥ç»“åˆGithubå¼€æºçš„è¡¨æƒ…è¯†åˆ«ä»£ç ä¸€èµ·ç ”ç©¶</p>
</blockquote>
<ul>
<li>è·¯å¾„å¤„ç† <code>os.path.sep</code>ï¼š æå–è·¯å¾„åˆ†éš”ç¬¦</li>
<li>æ•°æ®ä¸å¹³è¡¡çš„å¤„ç†ï¼Œå¯ä»¥è€ƒè™‘ä¸åŒåˆ†ç±»çš„æƒé‡ï¼Œåœ¨è®­ç»ƒæ—¶é€šè¿‡èµ‹æƒè°ƒæ•´å¹³è¡¡æ€§ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Handle data imbalance</span></span><br><span class="line"><span class="comment"># account for skew in the labeled data</span></span><br><span class="line">classTotals = labels.sum(axis=<span class="number">0</span>)</span><br><span class="line">classWeight = classTotals.max() / classTotals</span><br><span class="line"></span><br><span class="line"><span class="comment">## When training</span></span><br><span class="line">H = model.fit(trainX, trainY, validation_data=(testX, testY),</span><br><span class="line">    class_weight=classWeight, batch_size=<span class="number">64</span>, epochs=<span class="number">15</span>, verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æ‰‹å†™å­—çš„é¢„å¤„ç†"><a href="#æ‰‹å†™å­—çš„é¢„å¤„ç†" class="headerlink" title="æ‰‹å†™å­—çš„é¢„å¤„ç†"></a>æ‰‹å†™å­—çš„é¢„å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preprocess</span><span class="params">(image, width, height)</span>:</span></span><br><span class="line">    <span class="comment">#grap the dimensions of the image, then initialize the padding values</span></span><br><span class="line">    (h, w) = image.shape[:<span class="number">2</span>]</span><br><span class="line">    <span class="comment">#if width greater than height, resize along the width</span></span><br><span class="line">    <span class="keyword">if</span> w &gt; h:</span><br><span class="line">        image = imutils.resize(iamge, width=width)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        image = imutils.resize(image, height=height)</span><br><span class="line">    <span class="comment">#padding values for w and h to obtain the target dimensions</span></span><br><span class="line">    padW = int((width - image.shape[<span class="number">1</span>])/<span class="number">2.0</span>)</span><br><span class="line">    padH = int((height - image.shape[<span class="number">0</span>])/<span class="number">2.0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#pad the image then apply one more resizing to handle any rounding issues</span></span><br><span class="line">    image = cv2.copyMakeBorder(image, padH, padH, padW, padW, cv2.BORDER_REPLICATE)</span><br><span class="line">    iamge = cv2.resize(image, (width, height))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line">image = cv2.imread(img)</span><br><span class="line">gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line">gray = cv2.copyMakeBorder(gray, <span class="number">20</span>,<span class="number">20</span>,<span class="number">20</span>,<span class="number">20</span>, cv2.BORDER_REPLICATE)</span><br><span class="line"><span class="comment"># threshold the image to reveal the digits</span></span><br><span class="line">thresh = cv2.threshold(gray, <span class="number">0</span>, <span class="number">255</span>, cv2.THRESH_BINARY_INV | cv2.THRESH_OTSU)[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#find contours in the image, keeping only the four largest ones</span></span><br><span class="line">cnts = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span><br><span class="line">cnts = cnts[<span class="number">0</span>] <span class="keyword">if</span> imutils.is_cv2() <span class="keyword">else</span> cnts[<span class="number">1</span>]</span><br><span class="line">cnts = sorted(cnts, key=cv2.contourArea, reverse=<span class="keyword">True</span>)[:<span class="number">4</span>]</span><br><span class="line">cnts = contours.sort_contours(cnts)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the output image as a "grayscale" image with 3</span></span><br><span class="line"><span class="comment"># channels along with the output predictions</span></span><br><span class="line">output = cv2.merge([gray] * <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cnts:</span><br><span class="line">    <span class="comment"># compute the bounding box for the contour then extract the</span></span><br><span class="line">    <span class="comment"># digit</span></span><br><span class="line">    (x, y, w, h) = cv2.boundingRect(c)</span><br><span class="line">    roi = gray[y - <span class="number">5</span>:y + h + <span class="number">5</span>, x - <span class="number">5</span>:x + w + <span class="number">5</span>] </span><br><span class="line">    roi = preprocess(roi, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    roi = np.expand_dims(img_to_array(roi), axis=<span class="number">0</span>) / <span class="number">255.0</span></span><br><span class="line">    <span class="comment">#pred = model.predict(roi).argmax(axis=1)[0] + 1</span></span><br><span class="line">    <span class="comment">#predictions.append(str(pred))</span></span><br><span class="line">    <span class="comment"># draw the prediction on the output image</span></span><br><span class="line">    cv2.rectangle(output, (x - <span class="number">2</span>, y - <span class="number">2</span>),(x + w + <span class="number">4</span>, y + h + <span class="number">4</span>), (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">1</span>)</span><br><span class="line">    <span class="comment">#cv2.putText(output, str(pred), (x - 5, y - 5),cv2.FONT_HERSHEY_SIMPLEX, 0.55, (0, 255, 0), 2)</span></span><br><span class="line"><span class="comment"># show the output image</span></span><br><span class="line"><span class="comment">#print("[INFO] captcha: &#123;&#125;".format("".join(predictions)))</span></span><br><span class="line"></span><br><span class="line">plt.imshow(output)</span><br><span class="line"><span class="comment">#cv2.waitKey()</span></span><br></pre></td></tr></table></figure>
<h2 id="Useful-Functions"><a href="#Useful-Functions" class="headerlink" title="Useful Functions"></a>Useful Functions</h2><h3 id="å›¾åƒé¢„å¤„ç†åŠåŠ è½½æ¨¡æ¿"><a href="#å›¾åƒé¢„å¤„ç†åŠåŠ è½½æ¨¡æ¿" class="headerlink" title="å›¾åƒé¢„å¤„ç†åŠåŠ è½½æ¨¡æ¿"></a>å›¾åƒé¢„å¤„ç†åŠåŠ è½½æ¨¡æ¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">File1: Preprocessor</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimplePreporcessor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, width, height, inter=cv2.INTER_AREA)</span>ï¼š</span></span><br><span class="line">        # store the target image width, height, and interpolation method used when resizing</span><br><span class="line">        self.width = width</span><br><span class="line">        self.height = height</span><br><span class="line">        self.inter = inter</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preprocess</span><span class="params">(self, image)</span>:</span></span><br><span class="line">        <span class="comment"># resize the image to a fixed size, ignoring the aspect ratio</span></span><br><span class="line">        <span class="keyword">return</span> cv2.resize(image, (self.width, self.height), interpolation = self.inter)</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Data Loader</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># import the necessary packages </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> cv2 </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleDatasetLoader</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, preprocessors=None)</span>:</span></span><br><span class="line">        self.preprocessors = preprocessors</span><br><span class="line">        <span class="comment"># if the preprocessors are None, initialize them as an empty list</span></span><br><span class="line">        <span class="keyword">if</span> self.preprocessors <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            self.preprocessors = []</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">load</span><span class="params">(self, imagePaths, verbose =<span class="number">-1</span>)</span>:</span></span><br><span class="line">        data = []</span><br><span class="line">        labels = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i, imagePath) <span class="keyword">in</span> enumerate(imagePaths):</span><br><span class="line">           <span class="comment"># load the image and extract the class label assuming </span></span><br><span class="line">           <span class="comment"># # that our path has the following format: </span></span><br><span class="line">           <span class="comment"># # /path/to/dataset/&#123;class&#125;/&#123;image&#125;.jpg   </span></span><br><span class="line">           image = cv2.imread(imagePath)</span><br><span class="line">           label = imagePath.split(os.path.sep)[<span class="number">-2</span>]</span><br><span class="line"></span><br><span class="line">           <span class="comment"># check to see if our preprocessors are not None</span></span><br><span class="line">           <span class="keyword">if</span> self.preprocessors <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">               <span class="keyword">for</span> p <span class="keyword">in</span> self.preprocessors:</span><br><span class="line">                   image = p.preprocess(image)</span><br><span class="line">            </span><br><span class="line">            data.append(image)</span><br><span class="line">            labels.append(label)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># show an update every â€˜verboseâ€˜ images</span></span><br><span class="line">            <span class="keyword">if</span> verbose &gt;<span class="number">0</span> <span class="keyword">and</span> i &gt;<span class="number">0</span> <span class="keyword">and</span> (i+<span class="number">1</span>)%verbose == <span class="number">0</span>:</span><br><span class="line">                print(<span class="string">"[INFON] process &#123;&#125;/&#123;&#125;"</span>).format(i+<span class="number">1</span>,len(imagePaths))</span><br><span class="line">        <span class="comment"># return a tuple of the data and labels</span></span><br><span class="line">        <span class="keyword">return</span> (np.array(data), np.array(labels))</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Main</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># import the necessary packages</span></span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier </span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder </span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"><span class="keyword">from</span> imutils <span class="keyword">import</span> paths </span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># construct the argument parse and parse the arguments ap = argparse.ArgumentParser()</span></span><br><span class="line">ap.add_argument(<span class="string">"-d"</span>, <span class="string">"--dataset"</span>, required=<span class="keyword">True</span>, help=<span class="string">"path to input dataset"</span>)</span><br><span class="line">ap.add_argument(<span class="string">"-k"</span>, <span class="string">"--neighbors"</span>, type=int, default=<span class="number">1</span>, help=<span class="string">"# of nearest neighbors for classification"</span>)</span><br><span class="line"> ap.add_argument(<span class="string">"-j"</span>, <span class="string">"--jobs"</span>, type=int, default=<span class="number">-1</span>, help=<span class="string">"# of jobs for k-NN distance (-1 uses all available cores)"</span>)</span><br><span class="line">args = vars(ap.parse_args())</span><br><span class="line"></span><br><span class="line">print(<span class="string">"[INFO] loading images ..."</span>)</span><br><span class="line">imagePaths = list(paths.list_images(args[<span class="string">"dataset"</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the image preprocessor, load the dataset from disk,</span></span><br><span class="line"><span class="comment"># and reshape the data matrix</span></span><br><span class="line">sp = SimplePreporcessor(<span class="number">32</span>, <span class="number">32</span>)</span><br><span class="line">sdl = SimpleDatasetLoader(preprocessors=[sp])</span><br><span class="line"></span><br><span class="line">(data, labels) = sdl.load(imagePaths, verbose=<span class="number">500</span>)</span><br><span class="line"><span class="comment">#flatten for use in KNN</span></span><br><span class="line">data = data.reshape((data.shape[<span class="number">0</span>],<span class="number">32</span>*<span class="number">32</span>*<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"[INFO] feature matrix: &#123;:.1f&#125;MB"</span>).format(data.nbytes/(<span class="number">1024</span>*<span class="number">1000.0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># encode the labels as integers</span></span><br><span class="line">le = LabelEncoder()</span><br><span class="line">labels = le.fit_transform(labels)</span><br><span class="line"></span><br><span class="line">(trainX, testX, trainY, testY) = train_test_split(data, labels, test_size=<span class="number">0.25</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># train and evaluate a kNN classifier on raw pixel intensities</span></span><br><span class="line">print(<span class="string">"[INFO] evaluate kNN classifier ..."</span>)</span><br><span class="line">model = KNeighborsClassifier(n_neighbors=args[<span class="string">"neighbors"</span>]), n_jobs=args[<span class="string">"jobs"</span>])</span><br><span class="line">model.fit(trainX, trainY)</span><br><span class="line">print(classification_report(testY, model.predict(testX),target_names==le.classes_))</span><br></pre></td></tr></table></figure>
<h3 id="sklearn-metrics-classification-report"><a href="#sklearn-metrics-classification-report" class="headerlink" title="sklearn.metrics.classification_report"></a><code>sklearn.metrics.classification_report</code></h3><p>sklearnä¸­çš„classification_reportå‡½æ•°ç”¨äºæ˜¾ç¤ºä¸»è¦åˆ†ç±»æŒ‡æ ‡çš„æ–‡æœ¬æŠ¥å‘Šï¼åœ¨æŠ¥å‘Šä¸­æ˜¾ç¤ºæ¯ä¸ªç±»çš„ç²¾ç¡®åº¦ï¼Œå¬å›ç‡ï¼ŒF1å€¼ç­‰ä¿¡æ¯ã€‚<br><strong>ä¸»è¦å‚æ•°:</strong> </p>
<ul>
<li>y_trueï¼š1ç»´æ•°ç»„ï¼Œæˆ–æ ‡ç­¾æŒ‡ç¤ºå™¨æ•°ç»„/ç¨€ç–çŸ©é˜µï¼Œç›®æ ‡å€¼ã€‚ </li>
<li>y_predï¼š1ç»´æ•°ç»„ï¼Œæˆ–æ ‡ç­¾æŒ‡ç¤ºå™¨æ•°ç»„/ç¨€ç–çŸ©é˜µï¼Œåˆ†ç±»å™¨è¿”å›çš„ä¼°è®¡å€¼ã€‚ </li>
<li>labelsï¼šarrayï¼Œshape = [n_labels]ï¼ŒæŠ¥è¡¨ä¸­åŒ…å«çš„æ ‡ç­¾ç´¢å¼•çš„å¯é€‰åˆ—è¡¨ã€‚ </li>
<li>target_namesï¼šå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œä¸æ ‡ç­¾åŒ¹é…çš„å¯é€‰æ˜¾ç¤ºåç§°ï¼ˆç›¸åŒé¡ºåºï¼‰ã€‚ </li>
<li>sample_weightï¼šç±»ä¼¼äºshape = [n_samples]çš„æ•°ç»„ï¼Œå¯é€‰é¡¹ï¼Œæ ·æœ¬æƒé‡ã€‚ </li>
<li>digitsï¼šintï¼Œè¾“å‡ºæµ®ç‚¹å€¼çš„ä½æ•°ï¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line">y_true = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">y_pred = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">target_names = [<span class="string">'class 0'</span>, <span class="string">'class 1'</span>, <span class="string">'class 2'</span>]</span><br><span class="line">print(classification_report(y_true, y_pred, target_names=target_names))</span><br></pre></td></tr></table></figure>
<h3 id="opencv-ç»™å›¾åƒæ·»åŠ æè¿°"><a href="#opencv-ç»™å›¾åƒæ·»åŠ æè¿°" class="headerlink" title="opencv ç»™å›¾åƒæ·»åŠ æè¿°"></a>opencv ç»™å›¾åƒæ·»åŠ æè¿°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="comment"># draw the label with the highest score on the image as our # prediction</span></span><br><span class="line">cv2.putText(orig, <span class="string">"Label: &#123;&#125;"</span>.format(labels[np.argmax(scores)]), (<span class="number">10</span>, <span class="number">30</span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="number">0.9</span>, (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Kerasä¸­çš„Checkpointæœºåˆ¶"><a href="#Kerasä¸­çš„Checkpointæœºåˆ¶" class="headerlink" title="Kerasä¸­çš„Checkpointæœºåˆ¶"></a>Kerasä¸­çš„Checkpointæœºåˆ¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> ModelCheckpoint</span><br><span class="line"></span><br><span class="line"><span class="comment"># construct the callback to save only the *best* model to disk</span></span><br><span class="line"><span class="comment"># based on the validation loss</span></span><br><span class="line">fname = os.path.sep.join([args[<span class="string">"weights"</span>],</span><br><span class="line">	<span class="string">"weights-&#123;epoch:03d&#125;-&#123;val_loss:.4f&#125;.hdf5"</span>])</span><br><span class="line">checkpoint = ModelCheckpoint(fname, monitor=<span class="string">"val_loss"</span>, mode=<span class="string">"min"</span>,</span><br><span class="line">	save_best_only=<span class="keyword">True</span>, verbose=<span class="number">1</span>)</span><br><span class="line">callbacks = [checkpoint]</span><br><span class="line"></span><br><span class="line">print(<span class="string">"[INFO] training network..."</span>)</span><br><span class="line">H = model.fit(trainX, trainY, validation_data=(testX, testY),</span><br><span class="line">	batch_size=<span class="number">64</span>, epochs=<span class="number">40</span>, callbacks=callbacks, verbose=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><strong>å‚æ•°ï¼š</strong></p>
<ul>
<li>filenameï¼šå­—ç¬¦ä¸²ï¼Œä¿å­˜æ¨¡å‹çš„è·¯å¾„</li>
<li>monitorï¼šéœ€è¦ç›‘è§†çš„å€¼</li>
<li>verboseï¼šä¿¡æ¯å±•ç¤ºæ¨¡å¼ï¼Œ0æˆ–1</li>
<li>save_best_onlyï¼šå½“è®¾ç½®ä¸º<code>True</code>æ—¶ï¼Œå°†åªä¿å­˜åœ¨éªŒè¯é›†ä¸Šæ€§èƒ½æœ€å¥½çš„æ¨¡å‹</li>
<li>modeï¼šâ€˜autoâ€™ï¼Œâ€˜minâ€™ï¼Œâ€˜maxâ€™ä¹‹ä¸€ï¼Œåœ¨<code>save_best_only=True</code>æ—¶å†³å®šæ€§èƒ½æœ€ä½³æ¨¡å‹çš„è¯„åˆ¤å‡†åˆ™ï¼Œä¾‹å¦‚ï¼Œå½“ç›‘æµ‹å€¼ä¸º<code>val_acc</code>æ—¶ï¼Œæ¨¡å¼åº”ä¸º<code>max</code>ï¼Œå½“æ£€æµ‹å€¼ä¸º<code>val_loss</code>æ—¶ï¼Œæ¨¡å¼åº”ä¸º<code>min</code>ã€‚åœ¨<code>auto</code>æ¨¡å¼ä¸‹ï¼Œè¯„ä»·å‡†åˆ™ç”±è¢«ç›‘æµ‹å€¼çš„åå­—è‡ªåŠ¨æ¨æ–­ã€‚</li>
<li>save_weights_onlyï¼šè‹¥è®¾ç½®ä¸ºTrueï¼Œåˆ™åªä¿å­˜æ¨¡å‹æƒé‡ï¼Œå¦åˆ™å°†ä¿å­˜æ•´ä¸ªæ¨¡å‹ï¼ˆåŒ…æ‹¬æ¨¡å‹ç»“æ„ï¼Œé…ç½®ä¿¡æ¯ç­‰ï¼‰</li>
<li>periodï¼šCheckPointä¹‹é—´çš„é—´éš”çš„epochæ•°</li>
</ul>
<blockquote>
<ol>
<li>å¯ä»¥monitor losså€¼ä¹Ÿå¯ä»¥æ˜¯val_accï¼Œtrain_loss, train_acc;</li>
<li>æ›´å¤šå†…å®¹å‚è§ï¼š<a href="http://keras-cn.readthedocs.io/en/latest/other/callbacks/">http://keras-cn.readthedocs.io/en/latest/other/callbacks/</a></li>
</ol>
</blockquote>
<h3 id="EarlyStopping"><a href="#EarlyStopping" class="headerlink" title="EarlyStopping"></a>EarlyStopping</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keras.callbacks.EarlyStopping(monitor=<span class="string">'val_loss'</span>, patience=<span class="number">0</span>, verbose=<span class="number">0</span>, mode=<span class="string">'auto'</span>)</span><br></pre></td></tr></table></figure>
<p>å½“ç›‘æµ‹å€¼ä¸å†æ”¹å–„æ—¶ï¼Œè¯¥å›è°ƒå‡½æ•°å°†ä¸­æ­¢è®­ç»ƒ</p>
<p><strong>å‚æ•°</strong></p>
<ul>
<li>monitorï¼šéœ€è¦ç›‘è§†çš„é‡</li>
<li>patienceï¼šå½“early stopè¢«æ¿€æ´»ï¼ˆå¦‚å‘ç°lossç›¸æ¯”ä¸Šä¸€ä¸ªepochè®­ç»ƒæ²¡æœ‰ä¸‹é™ï¼‰ï¼Œåˆ™ç»è¿‡<code>patience</code>ä¸ªepochååœæ­¢è®­ç»ƒã€‚</li>
<li>verboseï¼šä¿¡æ¯å±•ç¤ºæ¨¡å¼</li>
<li>modeï¼šâ€˜autoâ€™ï¼Œâ€˜minâ€™ï¼Œâ€˜maxâ€™ä¹‹ä¸€ï¼Œåœ¨<code>min</code>æ¨¡å¼ä¸‹ï¼Œå¦‚æœæ£€æµ‹å€¼åœæ­¢ä¸‹é™åˆ™ä¸­æ­¢è®­ç»ƒã€‚åœ¨<code>max</code>æ¨¡å¼ä¸‹ï¼Œå½“æ£€æµ‹å€¼ä¸å†ä¸Šå‡åˆ™åœæ­¢è®­ç»ƒã€‚</li>
</ul>
<h3 id="åŸºäºkeras-callbackå®ç°è®­ç»ƒè¿‡ç¨‹ç›‘æ§"><a href="#åŸºäºkeras-callbackå®ç°è®­ç»ƒè¿‡ç¨‹ç›‘æ§" class="headerlink" title="åŸºäºkeras callbackå®ç°è®­ç»ƒè¿‡ç¨‹ç›‘æ§"></a>åŸºäºkeras callbackå®ç°è®­ç»ƒè¿‡ç¨‹ç›‘æ§</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import the necessary packages</span></span><br><span class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> BaseLogger</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrainingMonitor</span><span class="params">(BaseLogger)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, figPath, jsonPath=None, startAt=<span class="number">0</span>)</span>:</span></span><br><span class="line">        <span class="comment"># store the output path for the figure, the path to the JSON serialized file, and the starting epoch</span></span><br><span class="line">        super(TrainingMonitor, self).__init__()</span><br><span class="line">        self.figPath = figPath</span><br><span class="line">        self.jsonPath = jsonPath</span><br><span class="line">        self.startAt = startAt</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_train_begin</span><span class="params">(self, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        <span class="comment"># initialize the history dictionary</span></span><br><span class="line">        self.H = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># if the JSON history path exists, load the training history</span></span><br><span class="line">        <span class="keyword">if</span> self.jsonPath <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> os.path.exists(self.jsonPath):</span><br><span class="line">                self.H = json.loads(open(self.jsonPath).read())</span><br><span class="line"></span><br><span class="line">                <span class="comment"># check to see if a starting epoch was supplied</span></span><br><span class="line">                <span class="keyword">if</span> self.startAt &gt; <span class="number">0</span>:</span><br><span class="line">                    <span class="comment"># loop over the entries in the history log and</span></span><br><span class="line">                    <span class="comment"># trim any entries that are past the starting</span></span><br><span class="line">                    <span class="comment"># epoch</span></span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> self.H.keys():</span><br><span class="line">                        self.H[k] = self.H[k][:self.startAt]</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_epoch_end</span><span class="params">(self, epoch, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        <span class="comment"># loop over the logs and update the loss, accuracy, etc.</span></span><br><span class="line">        <span class="comment"># for the entire training process</span></span><br><span class="line">        <span class="keyword">for</span> (k, v) <span class="keyword">in</span> logs.items():</span><br><span class="line">            l = self.H.get(k, [])</span><br><span class="line">            l.append(v)</span><br><span class="line">            self.H[k] = l</span><br><span class="line">        <span class="comment"># check to see if the training history should be serialized</span></span><br><span class="line">        <span class="comment"># to file</span></span><br><span class="line">        <span class="keyword">if</span> self.jsonPath <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            f = open(self.jsonPath, <span class="string">"w"</span>)</span><br><span class="line">            f.write(json.dumps(self.H))</span><br><span class="line">            f.close()</span><br><span class="line">        <span class="comment"># ensure at least two epochs have passed before plotting</span></span><br><span class="line">        <span class="comment"># (epoch starts at zero)</span></span><br><span class="line">        <span class="keyword">if</span> len(self.H[<span class="string">"loss"</span>]) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="comment">#plot the training loss and accuracy</span></span><br><span class="line">            N = np.arange(<span class="number">0</span>, len(self.H[<span class="string">"loss"</span>]))</span><br><span class="line">            plt.style.use(<span class="string">"ggplot"</span>)</span><br><span class="line">            plt.figure()</span><br><span class="line">            plt.plot(N, self.H[<span class="string">"loss"</span>], label=<span class="string">"train_loss"</span>)</span><br><span class="line">            plt.plot(N, self.H[<span class="string">"val_loss"</span>], label=<span class="string">"val_loss"</span>)</span><br><span class="line">            plt.plot(N, self.H[<span class="string">"acc"</span>], label=<span class="string">"train_acc"</span>)</span><br><span class="line">            plt.plot(N, self.H[<span class="string">"val_acc"</span>], label=<span class="string">"val_acc"</span>)</span><br><span class="line">            plt.title(<span class="string">"Training Loss and Accuracy [Epoch &#123;&#125;]"</span>.format(len(self.H[<span class="string">"loss"</span>])))</span><br><span class="line">            plt.xlabel(<span class="string">"Epoch #"</span>)</span><br><span class="line">            plt.ylabel(<span class="string">"Loss/Accuracy"</span>)</span><br><span class="line">            plt.legend()</span><br><span class="line"></span><br><span class="line">            <span class="comment">#save the figure</span></span><br><span class="line">            plt.savefig(self.figPath)</span><br><span class="line">            plt.close()</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>figPath: The path to the output plot that we can use to visualize loss and accuracy over time.</li>
<li>jsonPath: An optional path used to serialize the loss and accuracy values as a JSON file. This path is useful if you want to use the training history to create custom plots of your own.</li>
<li>startAt: This is the starting epoch that training is resumed at when using ctrl + c training.</li>
</ul>
</blockquote>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2>
        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/photo.jpg" alt="Ebby">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Ebby
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        AI Learner
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>ShangHai</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        æ–‡ç« 
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            70
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        åˆ†ç±»
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            20
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        æ ‡ç­¾
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            71
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ddebby" target="_blank" rel="noopener">
                å…³æ³¨æˆ‘</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/ddebby">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://twitter.com/ebbydd">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            æ ‡ç­¾äº‘
        </h3>
        <a href="/tags/AI/" style="font-size: 17px;">AI</a> <a href="/tags/Ceph/" style="font-size: 11px;">Ceph</a> <a href="/tags/Fast-ai/" style="font-size: 10px;">Fast.ai</a> <a href="/tags/FastText/" style="font-size: 10px;">FastText</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Ipython/" style="font-size: 10px;">Ipython</a> <a href="/tags/JupyterNotebook/" style="font-size: 10px;">JupyterNotebook</a> <a href="/tags/Keras/" style="font-size: 10px;">Keras</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Numpy/" style="font-size: 10px;">Numpy</a> <a href="/tags/OpenCV/" style="font-size: 10px;">OpenCV</a> <a href="/tags/Pandas/" style="font-size: 10px;">Pandas</a> <a href="/tags/Prophet/" style="font-size: 10px;">Prophet</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SARIMA/" style="font-size: 10px;">SARIMA</a> <a href="/tags/Time-Series/" style="font-size: 10px;">Time Series</a> <a href="/tags/word2vec/" style="font-size: 11px;">word2vec</a> <a href="/tags/ä¹¦ç±/" style="font-size: 10px;">ä¹¦ç±</a> <a href="/tags/äº‘å­˜å‚¨/" style="font-size: 11px;">äº‘å­˜å‚¨</a> <a href="/tags/äººå·¥æ™ºèƒ½/" style="font-size: 20px;">äººå·¥æ™ºèƒ½</a> <a href="/tags/ä¼˜åŒ–/" style="font-size: 10px;">ä¼˜åŒ–</a> <a href="/tags/å…¬å¼€è¯¾/" style="font-size: 10px;">å…¬å¼€è¯¾</a> <a href="/tags/åšå®¢/" style="font-size: 10px;">åšå®¢</a> <a href="/tags/åŸç†è§£æ/" style="font-size: 10px;">åŸç†è§£æ</a> <a href="/tags/å¯è§†åŒ–/" style="font-size: 10px;">å¯è§†åŒ–</a> <a href="/tags/å›¾åƒåˆ†ç±»/" style="font-size: 11px;">å›¾åƒåˆ†ç±»</a> <a href="/tags/å®è·µ/" style="font-size: 12px;">å®è·µ</a> <a href="/tags/å®éªŒ/" style="font-size: 10px;">å®éªŒ</a> <a href="/tags/å·¥å…·/" style="font-size: 11px;">å·¥å…·</a> <a href="/tags/å·¥å…·ä½¿ç”¨/" style="font-size: 11px;">å·¥å…·ä½¿ç”¨</a> <a href="/tags/å·¥ç¨‹å®è·µ/" style="font-size: 10px;">å·¥ç¨‹å®è·µ</a> <a href="/tags/å¼€æ”¾æ•°æ®é›†/" style="font-size: 11px;">å¼€æ”¾æ•°æ®é›†</a> <a href="/tags/å¼€æºå¹³å°/" style="font-size: 10px;">å¼€æºå¹³å°</a> <a href="/tags/å¼ºåŒ–å­¦ä¹ /" style="font-size: 10px;">å¼ºåŒ–å­¦ä¹ </a> <a href="/tags/å¿ƒå¾—ä½“ä¼š/" style="font-size: 10px;">å¿ƒå¾—ä½“ä¼š</a> <a href="/tags/æ€»ç»“/" style="font-size: 13px;">æ€»ç»“</a> <a href="/tags/æ„Ÿæ‚Ÿ/" style="font-size: 11px;">æ„Ÿæ‚Ÿ</a> <a href="/tags/æ„ŸçŸ¥æœº/" style="font-size: 10px;">æ„ŸçŸ¥æœº</a> <a href="/tags/æŠ€å·§/" style="font-size: 12px;">æŠ€å·§</a> <a href="/tags/æŠ€æœ¯/" style="font-size: 11px;">æŠ€æœ¯</a> <a href="/tags/æ”¯æŒå‘é‡æœº/" style="font-size: 10px;">æ”¯æŒå‘é‡æœº</a> <a href="/tags/æ•™å­¦/" style="font-size: 12px;">æ•™å­¦</a> <a href="/tags/æ•°æ®/" style="font-size: 10px;">æ•°æ®</a> <a href="/tags/æ•°æ®æ ‡æ³¨/" style="font-size: 10px;">æ•°æ®æ ‡æ³¨</a> <a href="/tags/æ•°æ®é›†/" style="font-size: 10px;">æ•°æ®é›†</a> <a href="/tags/æ–‡çŒ®/" style="font-size: 18px;">æ–‡çŒ®</a> <a href="/tags/æ—¶åºæ•°æ®/" style="font-size: 11px;">æ—¶åºæ•°æ®</a> <a href="/tags/æœºå™¨å­¦ä¹ /" style="font-size: 13px;">æœºå™¨å­¦ä¹ </a> <a href="/tags/æœºå™¨è§†è§‰/" style="font-size: 16px;">æœºå™¨è§†è§‰</a> <a href="/tags/æ¨¡å‹/" style="font-size: 11px;">æ¨¡å‹</a> <a href="/tags/æ­£åˆ™åŒ–/" style="font-size: 10px;">æ­£åˆ™åŒ–</a> <a href="/tags/ç‰©ä½“è¯†åˆ«/" style="font-size: 12px;">ç‰©ä½“è¯†åˆ«</a> <a href="/tags/ç‰¹å¾æŠ½å–/" style="font-size: 10px;">ç‰¹å¾æŠ½å–</a> <a href="/tags/ç›®æ ‡æ£€æµ‹/" style="font-size: 10px;">ç›®æ ‡æ£€æµ‹</a> <a href="/tags/çŸ¥è¯†ç®¡ç†/" style="font-size: 10px;">çŸ¥è¯†ç®¡ç†</a> <a href="/tags/ç¥ç»ç½‘ç»œ/" style="font-size: 10px;">ç¥ç»ç½‘ç»œ</a> <a href="/tags/ç¬”è®°/" style="font-size: 15px;">ç¬”è®°</a> <a href="/tags/ç­–ç•¥/" style="font-size: 10px;">ç­–ç•¥</a> <a href="/tags/ç®—æ³•/" style="font-size: 19px;">ç®—æ³•</a> <a href="/tags/çº¿æ€§å›å½’/" style="font-size: 11px;">çº¿æ€§å›å½’</a> <a href="/tags/ç½‘ç»œå¤ç°/" style="font-size: 14px;">ç½‘ç»œå¤ç°</a> <a href="/tags/è®¡ç®—æœºè§†è§‰/" style="font-size: 11px;">è®¡ç®—æœºè§†è§‰</a> <a href="/tags/è¯å‘é‡/" style="font-size: 10px;">è¯å‘é‡</a> <a href="/tags/è¯åµŒå…¥/" style="font-size: 11px;">è¯åµŒå…¥</a> <a href="/tags/è¯»ä¹¦ç¬”è®°/" style="font-size: 14px;">è¯»ä¹¦ç¬”è®°</a> <a href="/tags/èµ„æºè°ƒåº¦/" style="font-size: 10px;">èµ„æºè°ƒåº¦</a> <a href="/tags/è¿ç§»å­¦ä¹ /" style="font-size: 10px;">è¿ç§»å­¦ä¹ </a> <a href="/tags/é€»è¾‘å›å½’/" style="font-size: 11px;">é€»è¾‘å›å½’</a> <a href="/tags/éƒ¨ç½²/" style="font-size: 11px;">éƒ¨ç½²</a> <a href="/tags/é…ç½®/" style="font-size: 10px;">é…ç½®</a> <a href="/tags/é¢„å¤„ç†/" style="font-size: 11px;">é¢„å¤„ç†</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                æ ‡ç­¾
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AI/">
                        <span class="tag">AI</span>
                        <span class="tag is-grey">15</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ceph/">
                        <span class="tag">Ceph</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Fast-ai/">
                        <span class="tag">Fast.ai</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/FastText/">
                        <span class="tag">FastText</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Git/">
                        <span class="tag">Git</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ipython/">
                        <span class="tag">Ipython</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JupyterNotebook/">
                        <span class="tag">JupyterNotebook</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Keras/">
                        <span class="tag">Keras</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Markdown/">
                        <span class="tag">Markdown</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Numpy/">
                        <span class="tag">Numpy</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OpenCV/">
                        <span class="tag">OpenCV</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Pandas/">
                        <span class="tag">Pandas</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Prophet/">
                        <span class="tag">Prophet</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Python/">
                        <span class="tag">Python</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SARIMA/">
                        <span class="tag">SARIMA</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Time-Series/">
                        <span class="tag">Time Series</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/word2vec/">
                        <span class="tag">word2vec</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ä¹¦ç±/">
                        <span class="tag">ä¹¦ç±</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/äº‘å­˜å‚¨/">
                        <span class="tag">äº‘å­˜å‚¨</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/äººå·¥æ™ºèƒ½/">
                        <span class="tag">äººå·¥æ™ºèƒ½</span>
                        <span class="tag is-grey">54</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ä¼˜åŒ–/">
                        <span class="tag">ä¼˜åŒ–</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å…¬å¼€è¯¾/">
                        <span class="tag">å…¬å¼€è¯¾</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/åšå®¢/">
                        <span class="tag">åšå®¢</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/åŸç†è§£æ/">
                        <span class="tag">åŸç†è§£æ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å¯è§†åŒ–/">
                        <span class="tag">å¯è§†åŒ–</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å›¾åƒåˆ†ç±»/">
                        <span class="tag">å›¾åƒåˆ†ç±»</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å®è·µ/">
                        <span class="tag">å®è·µ</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å®éªŒ/">
                        <span class="tag">å®éªŒ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å·¥å…·/">
                        <span class="tag">å·¥å…·</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å·¥å…·ä½¿ç”¨/">
                        <span class="tag">å·¥å…·ä½¿ç”¨</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å·¥ç¨‹å®è·µ/">
                        <span class="tag">å·¥ç¨‹å®è·µ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å¼€æ”¾æ•°æ®é›†/">
                        <span class="tag">å¼€æ”¾æ•°æ®é›†</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å¼€æºå¹³å°/">
                        <span class="tag">å¼€æºå¹³å°</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å¼ºåŒ–å­¦ä¹ /">
                        <span class="tag">å¼ºåŒ–å­¦ä¹ </span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/å¿ƒå¾—ä½“ä¼š/">
                        <span class="tag">å¿ƒå¾—ä½“ä¼š</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ€»ç»“/">
                        <span class="tag">æ€»ç»“</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ„Ÿæ‚Ÿ/">
                        <span class="tag">æ„Ÿæ‚Ÿ</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ„ŸçŸ¥æœº/">
                        <span class="tag">æ„ŸçŸ¥æœº</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æŠ€å·§/">
                        <span class="tag">æŠ€å·§</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æŠ€æœ¯/">
                        <span class="tag">æŠ€æœ¯</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ”¯æŒå‘é‡æœº/">
                        <span class="tag">æ”¯æŒå‘é‡æœº</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ•™å­¦/">
                        <span class="tag">æ•™å­¦</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ•°æ®/">
                        <span class="tag">æ•°æ®</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ•°æ®æ ‡æ³¨/">
                        <span class="tag">æ•°æ®æ ‡æ³¨</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ•°æ®é›†/">
                        <span class="tag">æ•°æ®é›†</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ–‡çŒ®/">
                        <span class="tag">æ–‡çŒ®</span>
                        <span class="tag is-grey">25</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ—¶åºæ•°æ®/">
                        <span class="tag">æ—¶åºæ•°æ®</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æœºå™¨å­¦ä¹ /">
                        <span class="tag">æœºå™¨å­¦ä¹ </span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æœºå™¨è§†è§‰/">
                        <span class="tag">æœºå™¨è§†è§‰</span>
                        <span class="tag is-grey">10</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ¨¡å‹/">
                        <span class="tag">æ¨¡å‹</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/æ­£åˆ™åŒ–/">
                        <span class="tag">æ­£åˆ™åŒ–</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç‰©ä½“è¯†åˆ«/">
                        <span class="tag">ç‰©ä½“è¯†åˆ«</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç‰¹å¾æŠ½å–/">
                        <span class="tag">ç‰¹å¾æŠ½å–</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç›®æ ‡æ£€æµ‹/">
                        <span class="tag">ç›®æ ‡æ£€æµ‹</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/çŸ¥è¯†ç®¡ç†/">
                        <span class="tag">çŸ¥è¯†ç®¡ç†</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç¥ç»ç½‘ç»œ/">
                        <span class="tag">ç¥ç»ç½‘ç»œ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç¬”è®°/">
                        <span class="tag">ç¬”è®°</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç­–ç•¥/">
                        <span class="tag">ç­–ç•¥</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç®—æ³•/">
                        <span class="tag">ç®—æ³•</span>
                        <span class="tag is-grey">35</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/çº¿æ€§å›å½’/">
                        <span class="tag">çº¿æ€§å›å½’</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ç½‘ç»œå¤ç°/">
                        <span class="tag">ç½‘ç»œå¤ç°</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/è®¡ç®—æœºè§†è§‰/">
                        <span class="tag">è®¡ç®—æœºè§†è§‰</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/è¯å‘é‡/">
                        <span class="tag">è¯å‘é‡</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/è¯åµŒå…¥/">
                        <span class="tag">è¯åµŒå…¥</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/è¯»ä¹¦ç¬”è®°/">
                        <span class="tag">è¯»ä¹¦ç¬”è®°</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/èµ„æºè°ƒåº¦/">
                        <span class="tag">èµ„æºè°ƒåº¦</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/è¿ç§»å­¦ä¹ /">
                        <span class="tag">è¿ç§»å­¦ä¹ </span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/é€»è¾‘å›å½’/">
                        <span class="tag">é€»è¾‘å›å½’</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/éƒ¨ç½²/">
                        <span class="tag">éƒ¨ç½²</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/é…ç½®/">
                        <span class="tag">é…ç½®</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/é¢„å¤„ç†/">
                        <span class="tag">é¢„å¤„ç†</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen is-sticky">
        
            
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            æœ€æ–°æ–‡ç« 
        </h3>
        
        <article class="media">
            
            <a href="/2021/02/05/é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-02-05T14:10:00.000Z">2021-02-05</time></div>
                    <a href="/2021/02/05/é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•/" class="title has-link-black-ter is-size-6 has-text-weight-normal">é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ€»ç»“/">æ€»ç»“</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/01/28/Reinforcement-Learning-Tips-and-Tricks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/blog/rl.jpg" alt="Reinforcement Learning:Tips and Tricks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-01-28T02:56:30.000Z">2021-01-28</time></div>
                    <a href="/2021/01/28/Reinforcement-Learning-Tips-and-Tricks/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Reinforcement Learning:Tips and Tricks</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/å¼ºåŒ–å­¦ä¹ /">å¼ºåŒ–å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/11/19/pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-11-19T05:00:18.000Z">2020-11-19</time></div>
                    <a href="/2020/11/19/pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²/" class="title has-link-black-ter is-size-6 has-text-weight-normal">pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/04/è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/blog/qxp.jpg" alt="è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-04T13:50:21.000Z">2020-05-04</time></div>
                    <a href="/2020/05/04/è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹/" class="title has-link-black-ter is-size-6 has-text-weight-normal">è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/04/19/è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/banner/02.jpg" alt="è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-19T07:10:45.000Z">2020-04-19</time></div>
                    <a href="/2020/04/19/è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°/" class="title has-link-black-ter is-size-6 has-text-weight-normal">è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            å½’æ¡£
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2021/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/11/">
                <span class="level-start">
                    <span class="level-item">åä¸€æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">å››æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">ä¸‰æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">åäºŒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">åä¸€æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">ä¹æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">å…«æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">ä¸ƒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">å…­æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">å››æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">ä¸‰æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right is-sticky">
    
        
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            æœ€æ–°æ–‡ç« 
        </h3>
        
        <article class="media">
            
            <a href="/2021/02/05/é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-02-05T14:10:00.000Z">2021-02-05</time></div>
                    <a href="/2021/02/05/é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•/" class="title has-link-black-ter is-size-6 has-text-weight-normal">é‚£äº›æ•ˆç‡æå‡çš„å·¥å…·ä¸æ–¹æ³•</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ€»ç»“/">æ€»ç»“</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/01/28/Reinforcement-Learning-Tips-and-Tricks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/blog/rl.jpg" alt="Reinforcement Learning:Tips and Tricks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-01-28T02:56:30.000Z">2021-01-28</time></div>
                    <a href="/2021/01/28/Reinforcement-Learning-Tips-and-Tricks/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Reinforcement Learning:Tips and Tricks</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/å¼ºåŒ–å­¦ä¹ /">å¼ºåŒ–å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/11/19/pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-11-19T05:00:18.000Z">2020-11-19</time></div>
                    <a href="/2020/11/19/pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²/" class="title has-link-black-ter is-size-6 has-text-weight-normal">pytorchæ¨¡å‹çš„å¯¼å‡ºä¸éƒ¨ç½²</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/04/è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/blog/qxp.jpg" alt="è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-04T13:50:21.000Z">2020-05-04</time></div>
                    <a href="/2020/05/04/è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹/" class="title has-link-black-ter is-size-6 has-text-weight-normal">è¯»ä¹¦ç¬”è®°-ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/04/19/è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/../qnsource/banner/02.jpg" alt="è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-19T07:10:45.000Z">2020-04-19</time></div>
                    <a href="/2020/04/19/è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°/" class="title has-link-black-ter is-size-6 has-text-weight-normal">è®¡ç®—æœºè§†è§‰ç›®æ ‡æ£€æµ‹ç ”ç©¶æœ­è®°</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            å½’æ¡£
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2021/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/11/">
                <span class="level-start">
                    <span class="level-item">åä¸€æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">å››æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">ä¸‰æœˆ 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">åäºŒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">åä¸€æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">ä¹æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">å…«æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">ä¸ƒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">å…­æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">äº”æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">å››æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">ä¸‰æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">ä¸€æœˆ 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">äºŒæœˆ 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo02.png" alt="Ebby&#39;s Notes" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2021 Ebby DD&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>  æ²ªICPå¤‡20005404å·
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'http://blog.a-stack.com',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'æ–‡ç« ',
                PAGES: 'é¡µé¢',
                CATEGORIES: 'åˆ†ç±»',
                TAGS: 'æ ‡ç­¾',
                UNTITLED: '(æ— æ ‡é¢˜)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>